<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Assortativity and Similarity | Handbook of Graphs and Networks in People Analytics</title>
<meta name="author" content="Keith McNulty">
<meta name="description" content="In this chapter we will round off our study of important graph concepts and metrics by looking at two new concepts which a people network analyst will often have good reason to study. The first...">
<meta name="generator" content="bookdown 0.22.15 with bs4_book()">
<meta property="og:title" content="9 Assortativity and Similarity | Handbook of Graphs and Networks in People Analytics">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ona-book.org/similarity.html">
<meta property="og:image" content="https://ona-book.org/www/cover/cover-ona.png">
<meta property="og:description" content="In this chapter we will round off our study of important graph concepts and metrics by looking at two new concepts which a people network analyst will often have good reason to study. The first...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Assortativity and Similarity | Handbook of Graphs and Networks in People Analytics">
<meta name="twitter:site" content="@dr_keithmcnulty">
<meta name="twitter:description" content="In this chapter we will round off our study of important graph concepts and metrics by looking at two new concepts which a people network analyst will often have good reason to study. The first...">
<meta name="twitter:image" content="https://ona-book.org/www/cover/cover-ona.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9.5/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-400FPN6D44"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-400FPN6D44');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="With Examples in R and Python">Handbook of Graphs and Networks in People Analytics</a>:
        <small class="text-muted">With Examples in R and Python</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="everywhere.html"><span class="header-section-number">1</span> Graphs Everywhere!</a></li>
<li><a class="" href="r-intro.html"><span class="header-section-number">2</span> The Basics of the R Programming Language</a></li>
<li><a class="" href="working.html"><span class="header-section-number">3</span> Working With Graphs</a></li>
<li><a class="" href="viz-graphs.html"><span class="header-section-number">4</span> Visualizing Graphs</a></li>
<li><a class="" href="restructuring-data.html"><span class="header-section-number">5</span> Restructuring Data For Use in Graphs</a></li>
<li><a class="" href="paths-distance.html"><span class="header-section-number">6</span> Paths and Distance</a></li>
<li><a class="" href="vertex-importance.html"><span class="header-section-number">7</span> Vertex Importance and Centrality</a></li>
<li><a class="" href="community.html"><span class="header-section-number">8</span> Components, Communities and Cliques</a></li>
<li><a class="active" href="similarity.html"><span class="header-section-number">9</span> Assortativity and Similarity</a></li>
<li><a class="" href="databases.html"><span class="header-section-number">10</span> Graphs as Databases</a></li>
<li><a class="" href="appendix-descriptions-of-data-sets-used.html">Appendix: Descriptions of Data Sets Used</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/keithmcnulty/ona_book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="similarity" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Assortativity and Similarity<a class="anchor" aria-label="anchor" href="#similarity"><i class="fas fa-link"></i></a>
</h1>
<p>In this chapter we will round off our study of important graph concepts and metrics by looking at two new concepts which a people network analyst will often have good reason to study. The first concept is assortativity, and this is described as the tendency of vertices to attach to vertices with similar properties in a graph. This is effectively a measure of homophily in a network. Highly assortative networks are more robust to destructive events like the loss of vertices, but because of their concentration they can be inefficient in terms of information flow and in organizational settings they can be problematic for diverse interaction and experience.</p>
<p>The second concept we will look at is vertex and graph similarity. In certain networks where information on vertex properties is not available, it may make sense to infer that two vertices are similar in some way if their immediate networks are very similar. The concept of similarity can be also extended to entire graphs. In the simplest case, we may be looking at the same set of vertices but using different definitions of connection, and we want a measure of whether those different definition produce substantially the same network or an entirely different network. As organizations start to mine many different forms of data to define connection (email, calendar, timesheet, document collaboration to name a few), it is becoming more and more important to understand the similarities or differences between the networks generated by these data sources.</p>
<div id="assortativity-in-networks" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Assortativity in networks<a class="anchor" aria-label="anchor" href="#assortativity-in-networks"><i class="fas fa-link"></i></a>
</h2>
<p>We have already seen in previous chapters that it is natural to want to study the extent to which vertices with similar ground truth properties are more densely connected in a graph. In Chapter <a href="community.html#community">8</a>, we studied examples where we looked at the how politicians representing the same political parties connect to each other over Twitter, or how schoolchildren in the same class connect over Facebook. In the exercises at the end of that chapter, we looked at how researcher communities form over email either within or between ground trust research departments.</p>
<p>The <strong>assortativity coefficient</strong> of a graph is a measure of the extent to which vertices with the same properties connect to each other. It is a relatively recently defined metric, and is defined slightly differently according to whether the property of interest is categorical (eg department or political party) or numeric (eg degree centrality). See <span class="citation"><a href="references.html#ref-newman" role="doc-biblioref">Newman</a> (<a href="references.html#ref-newman" role="doc-biblioref">2002</a>)</span> for a full description and mathematical definition.</p>
<p>The assortativity coefficient of a graph ranges between -1 and 1, just like a correlation coefficient. Assortativity coefficients close to 1 indicate that there is very high likelihood of two vertices with the same property being connected. This is called an assortative network. A coefficient of -1 indicates that there is very low likelihood of two vertcies with the same property being connected. This is called a disassortative network. Networks with coefficients close to zero are neither assortative nor disassortative and are usually described as neutral.</p>
<div id="categorical-or-nominal-assortativity" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Categorical or nominal assortativity<a class="anchor" aria-label="anchor" href="#categorical-or-nominal-assortativity"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s look at categorical assortativity first by bringing back two examples from the previous chapter. First we look at our Facebook schoolfriends network and calculate the assortativity by class. In R, we can use the <code><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity_nominal()</a></code> function to calculate categorical assortativity - see the end of this chapter for Python implementations. Note that these fuctions expect a numeric vector to indicate the category membership.</p>
<div class="sourceCode" id="cb501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>

<span class="co"># get data</span>
<span class="va">schoolfriends_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/schoolfriends_edgelist.csv"</span><span class="op">)</span>
<span class="va">schoolfriends_vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/schoolfriends_vertices.csv"</span><span class="op">)</span>

<span class="co"># create undirected Facebook graph</span>
<span class="va">schoolfriends_fb</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span>
  d <span class="op">=</span> <span class="va">schoolfriends_edgelist</span> |&gt; 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"facebook"</span><span class="op">)</span>,
  vertices <span class="op">=</span> <span class="va">schoolfriends_vertices</span>,
  directed <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># calculate assortativity by class for facebook</span>
<span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity_nominal</a></span><span class="op">(</span>
  <span class="va">schoolfriends_fb</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">schoolfriends_fb</span><span class="op">)</span><span class="op">$</span><span class="va">class</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3833667</code></pre>
<p>This suggests moderate assortativity, or moderate likelihood that students in the same class will be Facebook friends. Now let’s compare to ‘real’ reported friendships.</p>
<div class="sourceCode" id="cb503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create directed graph of reported friendships</span>
<span class="va">schoolfriends_rp</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span>
  d <span class="op">=</span> <span class="va">schoolfriends_edgelist</span> |&gt; 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"reported"</span><span class="op">)</span>,
  vertices <span class="op">=</span> <span class="va">schoolfriends_vertices</span>
<span class="op">)</span>

<span class="co"># calculate assortativity by class for reported</span>
<span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity_nominal</a></span><span class="op">(</span>
  <span class="va">schoolfriends_rp</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">schoolfriends_fb</span><span class="op">)</span><span class="op">$</span><span class="va">class</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.7188919</code></pre>
<p>We see substantially higher assortativity by class for reported friendships, indicating that being in the same class is more strongly associated with developing a reported school friendship.</p>
<div class="thinkahead">
<p><strong>Playing around:</strong> You may remember the concept of modularity which we introduced in Chapter <a href="community.html#community">8</a>. For categorical vertex properties, modularity and assortativity effectively measure the same thing. Calculate the modularity for the Facebook schoolfriends by class and compare it to the assortativity. Also, play around with some prior data sets and calculate the assortativity of some of the communities we detected in Chapter <a href="community.html#community">8</a>. Recall also our example for Chapter <a href="paths-distance.html#paths-distance">6</a> our example of breaking up the <code>workfrance</code> population to have tables with a good mix of different departments. If you completed that exercise you may be interested to compare the assortativity of that population by department versus by table to get a measure how how successful you were are creating diverse tables.</p>
</div>
</div>
<div id="degree-assortativity" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Degree assortativity<a class="anchor" aria-label="anchor" href="#degree-assortativity"><i class="fas fa-link"></i></a>
</h3>
<p>The most common form of numerical assortativity is degree assortativity. A high degree assortativity is a measure of preferential attachment in organizations, where highly connected vertices are connected with each other and a large number of vertices with low degree make up the remainder of the network.</p>
<p>Again, let’s use our schoolfriends networks as an example to calculate degree assortativity in R.</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># degree assortativity of facebook friendships (undirected)</span>
<span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity_degree</a></span><span class="op">(</span><span class="va">schoolfriends_fb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.02462444</code></pre>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># degree assortativity of facebook friendships (directed)</span>
<span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity_degree</a></span><span class="op">(</span><span class="va">schoolfriends_rp</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3098123</code></pre>
<p>We see that real life friendships are moderately assortative in this data, whereas Facebook friendships are approximatlely neutral. This indicates that more popular students have a stronger tendency in real life to be friends with other popular students.</p>
<p>Although it is a relatively recent concept, assortativity is a useful measure in understanding people or organizational networks. Highly assortative networks demonstrate resilience in that knowledge, community and other social capital are concentrated in a strong core, and disruptions such as departures of actors from those networks are less likely to affect the network as a whole. However, such networks also demonstrate characteristics which are counterproductive to diversity and inclusion, and can represent challenging environments for new entrants to adjust to.</p>
<p>It has been thought that social networks are unlike most other real life networks in that they are degree assortative. However, recent research has begun to question this. Although it does seem to be the case that social networks are more assortative than non-social networks, research on various datasets where the connection between individuals is direct (rather than inferred from joint membership of a group) suggests that social networks are likely neutrally assortative (<span class="citation"><a href="references.html#ref-fisher" role="doc-biblioref">Fisher, Silk, and Franks</a> (<a href="references.html#ref-fisher" role="doc-biblioref">2017</a>)</span>). This is a research topic of great interest currently in social network anaysis.</p>
</div>
</div>
<div id="vertex-similarity" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Vertex Similarity<a class="anchor" aria-label="anchor" href="#vertex-similarity"><i class="fas fa-link"></i></a>
</h2>
<p>Often we are not lucky enough to have really rich ground truth information on the vertices in a network. This is particularly the case if we need to analyze people networks under anonymization constraints. Nevertheless, as we have seen with examples in previous chapters like the <code>workfrance</code> graph and the <code>ontariopol</code> graph, computational methods allow us to infer conclusions about vertices and groups of vertices that can often be accurate representations of the ground truth properties of those vertices. In some networks, we can conclude that vertices are similar in some way if they share very similar immediate connections. For example, in our <code>workfrance</code> graph, if two vertices have first degree networks that overlap to a large degree, it would not be unreasonable to infer a likelihood that those two vertices are from the same department.</p>
<p>The <strong>vertex similarity coefficient</strong> of a pair of vertices is a measure of how similar the immediate networks of those two vertices are. Imagine we have two vertices <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> in an unweighted graph <span class="math inline">\(G\)</span>. There are three common ways to calculate the vertex similarity of <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span>, as follows:</p>
<ol style="list-style-type: decimal">
<li>The <em>Jaccard similarity coefficient</em> is the number of vertices who are neighbours of <em>both</em> <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> divided by the number of vertices who are neighbours of <em>at least one of</em> <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span>.</li>
<li>The <em>dice similarity coefficient</em> is twice the number of vertices who are neighbours of <em>both</em> <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> divided by the sum of the degree centralities of <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span>. Thus, common neighbours are double counted in this method, but are not in method 1.<br>
</li>
<li>The <em>inverse log-weighted similarity coefficient</em> is the sum of the inverse logs of the degrees of the common neighbours of <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span>. This definition asserts that common neighbors that have high degree in the network are ‘less valuable’ in detecting similarity because there is a higher likelihood that they would be a common neighbor simply by chance.</li>
</ol>
<p>To illustrate these three types of vertex similarity coefficients and show how they are calculated in R, let’s bring back our <span class="math inline">\(G_{14}\)</span> unweighted graph from Chapters <a href="paths-distance.html#paths-distance">6</a> and <a href="vertex-importance.html#vertex-importance">7</a>, and visualize it again in Figure <a href="similarity.html#fig:g14-9">9.1</a>.</p>
<div class="sourceCode" id="cb509"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="co"># download edgelist and create unweighted graph</span>
<span class="va">g14_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/g14_edgelist.csv"</span><span class="op">)</span>
<span class="va">g14</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">g14_edgelist</span> |&gt; 
                                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span>,
                                     directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># visualize</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="op">(</span><span class="va">g14viz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g14</span>, layout <span class="op">=</span> <span class="st">"lgl"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_label</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:g14-9"></span>
<img src="_main_files/figure-html/g14-9-1.png" alt="It's our old friend $G_{14}$ again" width="672"><p class="caption">
Figure 9.1: It’s our old friend <span class="math inline">\(G_{14}\)</span> again
</p>
</div>
<p>Let’s look at vertices 7 and 8 in <span class="math inline">\(G_{14}\)</span>. To calculate the Jaccard similarity coefficient, we note that vertices 4 and 9 are the two common neighbours of these vertices, and that vertices 4, 6, 7, 8 and 9 are all neighbours of at least one of vertices 7 and 8. Therefore we should see a Jaccard similarity coefficient of 0.4. We use the <code><a href="https://rdrr.io/pkg/igraph/man/similarity.html">similarity()</a></code> function in <code>igraph</code> who’s default is to calculate Jaccard similarity.</p>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/similarity.html">similarity</a></span><span class="op">(</span><span class="va">g14</span>, vids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7"</span>, <span class="st">"8"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  1.0  0.4
## [2,]  0.4  1.0</code></pre>
<p>We see in the off-diagonal components of this matrix confirmation of a Jaccard similarity coefficient of 0.4.</p>
<p>To calculate the dice similarity coefficient, we note that the sum of the degrees of vertices 7 and 8 is 7, therefore the dice similarity should equal 4/14 or 0.286.</p>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/similarity.html">similarity</a></span><span class="op">(</span><span class="va">g14</span>, vids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7"</span>, <span class="st">"8"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"dice"</span><span class="op">)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.5714286
## [2,] 0.5714286 1.0000000</code></pre>
<p>Finally, to calculate the inverse log weighted similarity coefficient, we sum inverse of the logs of the degrees of the common neighbours vertices 4 and 8, which is <span class="math inline">\(\frac{1}{\ln{7}} + \frac{1}{\ln{4}}\)</span>, which calculates to 1.235.</p>
<p>The output of this <code><a href="https://rdrr.io/pkg/igraph/man/similarity.html">similarity()</a></code> function variant returns the similarity of the selected vertices with all vertices in the network — try it if you like. In order to extract the specific similarity for vertices 7 and 8, we should ensure to label the rows and columns of the matrix by vertex name before extracting a specific value from it.</p>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get invlogweighted similarity</span>
<span class="va">invsim</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/similarity.html">similarity</a></span><span class="op">(</span><span class="va">g14</span>, method <span class="op">=</span> <span class="st">"invlogweighted"</span><span class="op">)</span>

<span class="co"># rows and cols should be labelled by vertex name before extracting values </span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">invsim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g14</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">invsim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g14</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>

<span class="co"># extract value for vertices 7 and 8</span>
<span class="va">invsim</span><span class="op">[</span><span class="st">"7"</span>, <span class="st">"8"</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 1.235246</code></pre>
<div class="thinkahead">
<p><strong>Playing around:</strong> Go back to some of our prior examples from Chapter <a href="community.html#community">8</a> where we detected communities of more densely connected vertices in graphs like <code>schoolfriends</code> and <code>ontariopol</code>. Play around with calculating the similarity between pairs of vertices inside communities versus between communities and think about whether the results make sense.</p>
</div>
</div>
<div id="graph-similarity" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Graph similarity<a class="anchor" aria-label="anchor" href="#graph-similarity"><i class="fas fa-link"></i></a>
</h2>
<p>The general question of whether two graphs which contain vertices representing different entities still exhibit similar internal patterns and structures is of great interest in computer science and image recognition. The <em>graph isomorphism</em> problem, for example, is a computational problem concerned with finding a function that exactly maps the vertices of one graph onto other<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The question of whether the graph isomorphism problem can be solved in polynomial time is one of a number of high-profile open graph problems currently.&lt;/p&gt;"><sup>70</sup></a>.</p>
<p>In organizational network analysis we are usually more concerned with comparing graphs where the vertices represent the same entities (usually people), and where the vertex set is identical but where the edge set may be different. An example of this is our <code>schoolfriends</code> data set from earlier in this chapter, where the vertices are the same set of high school students, but where the edge sets are different according to whether the friendships are Facebook friendships or ‘real’ reported friendships. In this situation we can use a common set similarity metric from set theory to determine how similar our graphs are..</p>
<p>Let <span class="math inline">\(G_1 = (V, E_1)\)</span> and <span class="math inline">\(G_2 = (V, E_2)\)</span> be two graphs with the same vertex set. The <em>Jaccard similarity</em> of <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span> is the number of edges in <em>both</em> <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> divided by the number of edges in <em>at least one</em> of <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span>.</p>
<p>Note that a Jaccard similarity of 1 means that both graphs have identical edge sets and so are identical in structure, and a similarity of 0 means that both graphs have no edges in common. Let’s try this on our <code>schoolfriends</code> graphs. To do a fair comparison, we will redefine our Facebook schoolfriends graph to be a directed graph where edges always go on both directions.</p>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create undirected Facebook graph</span>
<span class="va">schoolfriends_fb_dir</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html">as.directed</a></span><span class="op">(</span><span class="va">schoolfriends_fb</span><span class="op">)</span></code></pre></div>
<p>We can create a handy function to calculate the Jaccard similarity of the edge sets of two graphs. Note that the <code>igraph</code> package has special operators <code>$s%</code> for the intersection of two graphs (that is, all nodes and edges that both graphs have in common), and <code><a href="https://rdrr.io/pkg/igraph/man/union.igraph.html">%u%</a></code> for the union of two graphs (that is, all unique nodes and edges in both graphs combined).</p>
<div class="sourceCode" id="cb517"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># function for jaccard similarity of edges sets</span>
<span class="va">jaccard_edgeset_similarity</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">inter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">G1</span> <span class="op">%s%</span> <span class="va">G2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">un</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">G1</span> <span class="op">%u%</span> <span class="va">G2</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">un</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="fl">0</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">inter</span><span class="op">/</span><span class="va">un</span>
  <span class="op">}</span>
<span class="op">}</span>


<span class="co"># test</span>
<span class="fu">jaccard_edgeset_similarity</span><span class="op">(</span><span class="va">schoolfriends_fb_dir</span>, <span class="va">schoolfriends_rp</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.09727385</code></pre>
<p>We see that there is only about 10% similarity between the facebook friendships and the ‘real’ reported friendships.</p>
</div>
<div id="calculating-assortativity-and-similarity-in-python" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Calculating assortativity and similarity in Python<a class="anchor" aria-label="anchor" href="#calculating-assortativity-and-similarity-in-python"><i class="fas fa-link"></i></a>
</h2>
<p>To demonstrate assortativity functions we load up the <code>schoolfriends</code> data sets.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb519-1"><a href="similarity.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb519-2"><a href="similarity.html#cb519-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb519-3"><a href="similarity.html#cb519-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-4"><a href="similarity.html#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb519-5"><a href="similarity.html#cb519-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb519-6"><a href="similarity.html#cb519-6" aria-hidden="true" tabindex="-1"></a>schoolfriends_edgelist <span class="op">=</span> pd.read_csv(<span class="st">"https://ona-book.org/data/schoolfriends_edgelist.csv"</span>)</span>
<span id="cb519-7"><a href="similarity.html#cb519-7" aria-hidden="true" tabindex="-1"></a>schoolfriends_vertices <span class="op">=</span> pd.read_csv(<span class="st">"https://ona-book.org/data/schoolfriends_vertices.csv"</span>)</span>
<span id="cb519-8"><a href="similarity.html#cb519-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-9"><a href="similarity.html#cb519-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create undirected facebook graph</span></span>
<span id="cb519-10"><a href="similarity.html#cb519-10" aria-hidden="true" tabindex="-1"></a>schoolfriends_fb <span class="op">=</span> nx.from_pandas_edgelist(</span>
<span id="cb519-11"><a href="similarity.html#cb519-11" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> schoolfriends_edgelist[schoolfriends_edgelist.<span class="bu">type</span> <span class="op">==</span> <span class="st">'facebook'</span>],</span>
<span id="cb519-12"><a href="similarity.html#cb519-12" aria-hidden="true" tabindex="-1"></a>  source <span class="op">=</span> <span class="st">"from"</span>,</span>
<span id="cb519-13"><a href="similarity.html#cb519-13" aria-hidden="true" tabindex="-1"></a>  target <span class="op">=</span> <span class="st">"to"</span></span>
<span id="cb519-14"><a href="similarity.html#cb519-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb519-15"><a href="similarity.html#cb519-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-16"><a href="similarity.html#cb519-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create directed reported graph</span></span>
<span id="cb519-17"><a href="similarity.html#cb519-17" aria-hidden="true" tabindex="-1"></a>schoolfriends_rp <span class="op">=</span> nx.from_pandas_edgelist(</span>
<span id="cb519-18"><a href="similarity.html#cb519-18" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> schoolfriends_edgelist[schoolfriends_edgelist.<span class="bu">type</span> <span class="op">==</span> <span class="st">'reported'</span>],</span>
<span id="cb519-19"><a href="similarity.html#cb519-19" aria-hidden="true" tabindex="-1"></a>  source <span class="op">=</span> <span class="st">"from"</span>,</span>
<span id="cb519-20"><a href="similarity.html#cb519-20" aria-hidden="true" tabindex="-1"></a>  target <span class="op">=</span> <span class="st">"to"</span>,</span>
<span id="cb519-21"><a href="similarity.html#cb519-21" aria-hidden="true" tabindex="-1"></a>  create_using<span class="op">=</span>nx.DiGraph()</span>
<span id="cb519-22"><a href="similarity.html#cb519-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb519-23"><a href="similarity.html#cb519-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-24"><a href="similarity.html#cb519-24" aria-hidden="true" tabindex="-1"></a><span class="co"># add class vertex attribute to both graphs</span></span>
<span id="cb519-25"><a href="similarity.html#cb519-25" aria-hidden="true" tabindex="-1"></a>class_attr <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(schoolfriends_vertices[<span class="st">'id'</span>], schoolfriends_vertices[<span class="st">'class'</span>]))</span>
<span id="cb519-26"><a href="similarity.html#cb519-26" aria-hidden="true" tabindex="-1"></a>nx.set_node_attributes(schoolfriends_fb, name <span class="op">=</span> <span class="st">"class"</span>, values <span class="op">=</span> class_attr)</span>
<span id="cb519-27"><a href="similarity.html#cb519-27" aria-hidden="true" tabindex="-1"></a>nx.set_node_attributes(schoolfriends_rp, name <span class="op">=</span> <span class="st">"class"</span>, values <span class="op">=</span> class_attr)</span></code></pre></div>
<p>The <code>attribute_assortativity_coefficient()</code> and <code>degree_assortativity_coefficient()</code> functions can be used to calculate categorical assortativity and degree assortativity respectively.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb520-1"><a href="similarity.html#cb520-1" aria-hidden="true" tabindex="-1"></a>nx.attribute_assortativity_coefficient(schoolfriends_fb, <span class="st">"class"</span>)</span></code></pre></div>
<pre><code>## 0.3833666875368265</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb522-1"><a href="similarity.html#cb522-1" aria-hidden="true" tabindex="-1"></a>nx.attribute_assortativity_coefficient(schoolfriends_rp, <span class="st">"class"</span>)</span></code></pre></div>
<pre><code>## 0.7188918572576617</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb524-1"><a href="similarity.html#cb524-1" aria-hidden="true" tabindex="-1"></a>nx.degree_assortativity_coefficient(schoolfriends_fb)</span></code></pre></div>
<pre><code>## 0.024624435635859483</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb526-1"><a href="similarity.html#cb526-1" aria-hidden="true" tabindex="-1"></a>nx.degree_assortativity_coefficient(schoolfriends_rp)</span></code></pre></div>
<pre><code>## 0.30981226480406543</code></pre>
<p>To calculate Jaccard similarity between two vertices use the <code>jaccard_coefficient()</code> function in <code>networkx</code>. In this example we calculate the Jaccard coefficients for two pairs of vertices in <code>schoolfriends_fb</code>.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb528-1"><a href="similarity.html#cb528-1" aria-hidden="true" tabindex="-1"></a>jaccards <span class="op">=</span> nx.jaccard_coefficient(G <span class="op">=</span> schoolfriends_fb, ebunch <span class="op">=</span> [(<span class="dv">883</span>, <span class="dv">132</span>), (<span class="dv">63</span>, <span class="dv">991</span>)])</span>
<span id="cb528-2"><a href="similarity.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(jaccards)</span></code></pre></div>
<pre><code>## [(63, 991, 0.15384615384615385), (883, 132, 0.30612244897959184)]</code></pre>
<p>Dice similarity and inverse log weighted similarity coefficients can be calculated by creating functions.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb530-1"><a href="similarity.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for dice similarity</span></span>
<span id="cb530-2"><a href="similarity.html#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dice_coefficient(G, ebunch <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb530-3"><a href="similarity.html#cb530-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> dicesim(u, v):</span>
<span id="cb530-4"><a href="similarity.html#cb530-4" aria-hidden="true" tabindex="-1"></a>        total_degree <span class="op">=</span> nx.degree(G, u) <span class="op">+</span> nx.degree(G, v)</span>
<span id="cb530-5"><a href="similarity.html#cb530-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> total_degree <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb530-6"><a href="similarity.html#cb530-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb530-7"><a href="similarity.html#cb530-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span><span class="bu">len</span>(<span class="bu">list</span>(nx.common_neighbors(G, u, v))) <span class="op">/</span> total_degree</span>
<span id="cb530-8"><a href="similarity.html#cb530-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb530-9"><a href="similarity.html#cb530-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ebunch <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb530-10"><a href="similarity.html#cb530-10" aria-hidden="true" tabindex="-1"></a>        ebunch <span class="op">=</span> nx.non_edges(G)</span>
<span id="cb530-11"><a href="similarity.html#cb530-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> ((u, v, dicesim(u, v)) <span class="cf">for</span> u, v <span class="kw">in</span> ebunch)</span>
<span id="cb530-12"><a href="similarity.html#cb530-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-13"><a href="similarity.html#cb530-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb530-14"><a href="similarity.html#cb530-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb530-15"><a href="similarity.html#cb530-15" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb530-16"><a href="similarity.html#cb530-16" aria-hidden="true" tabindex="-1"></a>dice <span class="op">=</span> dice_coefficient(G <span class="op">=</span> schoolfriends_fb, ebunch <span class="op">=</span> [(<span class="dv">883</span>, <span class="dv">132</span>), (<span class="dv">63</span>, <span class="dv">991</span>)])</span>
<span id="cb530-17"><a href="similarity.html#cb530-17" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(dice)</span></code></pre></div>
<pre><code>## [(63, 991, 0.26666666666666666), (883, 132, 0.46875)]</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb532-1"><a href="similarity.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math </span>
<span id="cb532-2"><a href="similarity.html#cb532-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-3"><a href="similarity.html#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function for inverse log weighted similarity</span></span>
<span id="cb532-4"><a href="similarity.html#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> invlogweight_coefficient(G, ebunch <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb532-5"><a href="similarity.html#cb532-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">def</span> invlogwsim(u, v):</span>
<span id="cb532-6"><a href="similarity.html#cb532-6" aria-hidden="true" tabindex="-1"></a>        logw <span class="op">=</span> [<span class="dv">1</span><span class="op">/</span>math.log(nx.degree(G, w)) <span class="cf">for</span> w <span class="kw">in</span> nx.common_neighbors(G, u, v)]</span>
<span id="cb532-7"><a href="similarity.html#cb532-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> logw <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb532-8"><a href="similarity.html#cb532-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb532-9"><a href="similarity.html#cb532-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(i <span class="cf">for</span> i <span class="kw">in</span> logw)</span>
<span id="cb532-10"><a href="similarity.html#cb532-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb532-11"><a href="similarity.html#cb532-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ebunch <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb532-12"><a href="similarity.html#cb532-12" aria-hidden="true" tabindex="-1"></a>        ebunch <span class="op">=</span> nx.non_edges(G)</span>
<span id="cb532-13"><a href="similarity.html#cb532-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> ((u, v, invlogwsim(u, v)) <span class="cf">for</span> u, v <span class="kw">in</span> ebunch)</span>
<span id="cb532-14"><a href="similarity.html#cb532-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-15"><a href="similarity.html#cb532-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb532-16"><a href="similarity.html#cb532-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb532-17"><a href="similarity.html#cb532-17" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb532-18"><a href="similarity.html#cb532-18" aria-hidden="true" tabindex="-1"></a>invlogw <span class="op">=</span> invlogweight_coefficient(G <span class="op">=</span> schoolfriends_fb, ebunch <span class="op">=</span> [(<span class="dv">883</span>, <span class="dv">132</span>), (<span class="dv">63</span>, <span class="dv">991</span>)])</span>
<span id="cb532-19"><a href="similarity.html#cb532-19" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(invlogw)</span></code></pre></div>
<pre><code>## [(63, 991, 0.5728002621049868), (883, 132, 4.566433503199232)]</code></pre>
<p>Finally, to calculate Jaccard similarity of two edge sets a simple function can be written:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb534-1"><a href="similarity.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create functions for Jaccard edges set similarity</span></span>
<span id="cb534-2"><a href="similarity.html#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> jaccard_edgeset_similarity(G1, G2):</span>
<span id="cb534-3"><a href="similarity.html#cb534-3" aria-hidden="true" tabindex="-1"></a>  setG1 <span class="op">=</span> <span class="bu">set</span>(G1.edges)</span>
<span id="cb534-4"><a href="similarity.html#cb534-4" aria-hidden="true" tabindex="-1"></a>  intersection <span class="op">=</span> <span class="bu">len</span>(setG1.intersection(G2.edges))</span>
<span id="cb534-5"><a href="similarity.html#cb534-5" aria-hidden="true" tabindex="-1"></a>  union <span class="op">=</span> <span class="bu">len</span>(setG1.union(G2.edges))</span>
<span id="cb534-6"><a href="similarity.html#cb534-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb534-7"><a href="similarity.html#cb534-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> union <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb534-8"><a href="similarity.html#cb534-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb534-9"><a href="similarity.html#cb534-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> intersection<span class="op">/</span>union</span>
<span id="cb534-10"><a href="similarity.html#cb534-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-11"><a href="similarity.html#cb534-11" aria-hidden="true" tabindex="-1"></a><span class="co"># recreate schoolfriends_fb as directed graph to compare</span></span>
<span id="cb534-12"><a href="similarity.html#cb534-12" aria-hidden="true" tabindex="-1"></a>schoolfriends_fb_dir <span class="op">=</span> schoolfriends_fb.to_directed()</span>
<span id="cb534-13"><a href="similarity.html#cb534-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-14"><a href="similarity.html#cb534-14" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb534-15"><a href="similarity.html#cb534-15" aria-hidden="true" tabindex="-1"></a>jaccard_edgeset_similarity(schoolfriends_fb_dir, schoolfriends_rp)</span></code></pre></div>
<pre><code>## 0.09727385377942999</code></pre>
</div>
<div id="learning-exercises-7" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Learning exercises<a class="anchor" aria-label="anchor" href="#learning-exercises-7"><i class="fas fa-link"></i></a>
</h2>
<div id="discussion-questions-7" class="section level3" number="9.5.1">
<h3>
<span class="header-section-number">9.5.1</span> Discussion questions<a class="anchor" aria-label="anchor" href="#discussion-questions-7"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Describe the meaning of the term assortativity for vertices in a graph.</li>
<li>Describe the meaning of degree assortativity and discuss how it relates to the concept of preferential attachment.</li>
<li>Describe why assortativity and modularity are similar concepts in graph theory.</li>
<li>Describe the concept of vertex similarity and define two measures of vertex similarity.</li>
<li>Describe a method to compare the similarity of two graphs with the same vertex sets.</li>
</ol>
</div>
<div id="data-exercises-7" class="section level3" number="9.5.2">
<h3>
<span class="header-section-number">9.5.2</span> Data exercises<a class="anchor" aria-label="anchor" href="#data-exercises-7"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Calculate the gender assortativity coefficient in the two <code>schoolfriends</code> graph - what would you conclude from this?</li>
<li>Calculate the department assortativity coefficient in the <code>workfrance</code> graph from earlier chapters.</li>
<li>Calculate the degree assortativity coefficient of the <code>workfrance</code> and the <code>ontariopol</code> graphs from previous chapters. How would you describe the meaning of the difference between the two?</li>
<li>Choose pairs of vertices from the same department in the <code>workfrance</code> graph and calculate their Jaccard similarity coefficients. Then choose pairs from different departments and do the same. Do the results make sense? Why?</li>
<li>Find the three vertices with highest degree centrality in the <code>workfrance</code> graph, and calculate some pairwise similarity coefficients for them. Now do the same with three vertices with relatively low degree centrality. Do the results make sense? Why?</li>
</ol>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="community.html"><span class="header-section-number">8</span> Components, Communities and Cliques</a></div>
<div class="next"><a href="databases.html"><span class="header-section-number">10</span> Graphs as Databases</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#similarity"><span class="header-section-number">9</span> Assortativity and Similarity</a></li>
<li>
<a class="nav-link" href="#assortativity-in-networks"><span class="header-section-number">9.1</span> Assortativity in networks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#categorical-or-nominal-assortativity"><span class="header-section-number">9.1.1</span> Categorical or nominal assortativity</a></li>
<li><a class="nav-link" href="#degree-assortativity"><span class="header-section-number">9.1.2</span> Degree assortativity</a></li>
</ul>
</li>
<li><a class="nav-link" href="#vertex-similarity"><span class="header-section-number">9.2</span> Vertex Similarity</a></li>
<li><a class="nav-link" href="#graph-similarity"><span class="header-section-number">9.3</span> Graph similarity</a></li>
<li><a class="nav-link" href="#calculating-assortativity-and-similarity-in-python"><span class="header-section-number">9.4</span> Calculating assortativity and similarity in Python</a></li>
<li>
<a class="nav-link" href="#learning-exercises-7"><span class="header-section-number">9.5</span> Learning exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#discussion-questions-7"><span class="header-section-number">9.5.1</span> Discussion questions</a></li>
<li><a class="nav-link" href="#data-exercises-7"><span class="header-section-number">9.5.2</span> Data exercises</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/keithmcnulty/ona_book/blob/master/r/09-assortativity.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/keithmcnulty/ona_book/edit/master/r/09-assortativity.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Handbook of Graphs and Networks in People Analytics</strong>: With Examples in R and Python" was written by Keith McNulty. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
