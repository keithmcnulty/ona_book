<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Visualizing Graphs | Handbook of Graphs and Networks in People Analytics</title>
<meta name="author" content="Keith McNulty">
<meta name="description" content="Now that we have learned how to define and store graphs, it’s time to take a look at ways of visualizing them. As we noted in earlier chapters, visualization is an important tool that can make...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="3 Visualizing Graphs | Handbook of Graphs and Networks in People Analytics">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ona-book.org/viz-graphs.html">
<meta property="og:image" content="https://ona-book.org/www/cover/cover-ona.png">
<meta property="og:description" content="Now that we have learned how to define and store graphs, it’s time to take a look at ways of visualizing them. As we noted in earlier chapters, visualization is an important tool that can make...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Visualizing Graphs | Handbook of Graphs and Networks in People Analytics">
<meta name="twitter:site" content="@dr_keithmcnulty">
<meta name="twitter:description" content="Now that we have learned how to define and store graphs, it’s time to take a look at ways of visualizing them. As we noted in earlier chapters, visualization is an important tool that can make...">
<meta name="twitter:image" content="https://ona-book.org/www/cover/cover-ona.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><meta name="citation_title" content="3 Visualizing Graphs | Handbook of Graphs and Networks in People Analytics: With Examples in R and Python">
<meta name="citation_author" content="Keith McNulty">
<meta name="citation_publication_date" content="2022">
<meta name="citation_isbn" content="9781032204970">
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-400FPN6D44"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-400FPN6D44');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="With Examples in R and Python">Handbook of Graphs and Networks in People Analytics</a>:
        <small class="text-muted">With Examples in R and Python</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword-by-professor-jeff-polzer.html">Foreword by Professor Jeff Polzer</a></li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="the-basics-of-the-r-programming-language.html">The Basics of the R Programming Language</a></li>
<li><a class="" href="everywhere.html"><span class="header-section-number">1</span> Graphs Everywhere!</a></li>
<li><a class="" href="working.html"><span class="header-section-number">2</span> Working with Graphs</a></li>
<li><a class="active" href="viz-graphs.html"><span class="header-section-number">3</span> Visualizing Graphs</a></li>
<li><a class="" href="restructuring-data.html"><span class="header-section-number">4</span> Restructuring Data for Use in Graphs</a></li>
<li><a class="" href="paths-distance.html"><span class="header-section-number">5</span> Paths and Distance</a></li>
<li><a class="" href="vertex-importance.html"><span class="header-section-number">6</span> Vertex Importance and Centrality</a></li>
<li><a class="" href="community.html"><span class="header-section-number">7</span> Components, Communities and Cliques</a></li>
<li><a class="" href="similarity.html"><span class="header-section-number">8</span> Assortativity and Similarity</a></li>
<li><a class="" href="databases.html"><span class="header-section-number">9</span> Graphs as Databases</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/keithmcnulty/ona_book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="viz-graphs" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Visualizing Graphs<a class="anchor" aria-label="anchor" href="#viz-graphs"><i class="fas fa-link"></i></a>
</h1>
<p>Now that we have learned how to define and store graphs, it’s time to take a look at ways of visualizing them. As we noted in earlier chapters, visualization is an important tool that can make graphs and networks real to others. But visualizations are not always effective. Graphs can be laid out and visualized in many different ways, and only some of them will effectively communicate the inferences or conclusions that the analyst is inviting others to draw about the phenomena being represented in the graph.</p>
<p>While a graph is made up of vertices and edges, there are many other factors that will impact how the graph appears. First, there are cosmetic matters of vertex size, edge thickness, whether or not vertices and edges are labelled, colored and so on. Second, there are matters of layout—that is, where we position vertices relative to each other in our visualization. As an example, recall our simple four vertex undirected graph <span class="math inline">\(G_\mathrm{work}\)</span> from Section <a href="working.html#graph-def">2.1.1</a>. Figure <a href="viz-graphs.html#fig:two-viz-gwork">3.1</a> shows two different ways of visualizing this graph, where we make different choices on vertex size and on graph layout<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The right-hand visualization uses the degree centrality of the vertices to scale their size—we will learn about this later. The layouts are also different. The left-hand visualization uses a grid layout, while the right-hand visualization uses a metric multidimensional scaling (MDS) layout.&lt;/p&gt;"><sup>24</sup></a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:two-viz-gwork"></span>
<img src="_main_files/figure-html/two-viz-gwork-1.png" alt="Two different ways of visualizing the $G_\mathrm{work}$ graph" width="90%"><p class="caption">
Figure 3.1: Two different ways of visualizing the <span class="math inline">\(G_\mathrm{work}\)</span> graph
</p>
</div>
<p>The choices of how to visualize a graph are wide and varied, and we will not be covering every single permutation and combination of cosmetics and layouts in the chapter. Instead, we will focus on learning how to control the most common options. This will equip readers well not just for work we do later in this book, but also for when they need to visualize graphs they create as part of their work or study. We will also cover a variety of graph visualization programming package options in R and Python.</p>
<p>In this chapter we will work with a relatively famous graph known as <em>Zachary’s Karate Club</em>. This graph originates from a piece of research on a karate club by social anthropologist Wayne W. Zachary<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="citation"&gt;Zachary (&lt;a href="references.html#ref-zachary"&gt;1977&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;'><sup>25</sup></a>, and is commonly used as an example of a social network in many teaching situations today. The graph contains 34 vertices representing different individuals or actors. The karate instructor is labelled as ‘Mr Hi’. The club administrator is labelled as ‘John A’. The other 32 actors are labelled as ‘Actor 2’ through ‘Actor 33’. Zachary studied the social interactions between the members outside the club meetings, and during his study a conflict arose in the club that eventually led to the group splitting into two: one group forming a new club around the instructor Mr Hi and the other group dispersing to find new clubs or to give up karate completely. In this graph, an edge between two vertices means that the two individuals interacted socially outside the club.</p>
<div id="visualizing-graphs-in-r" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Visualizing graphs in R<a class="anchor" aria-label="anchor" href="#visualizing-graphs-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s load the <code>karate</code> graph edgelist in R from the <code>onadata</code> package or from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/karate.csv" class="uri"&gt;https://ona-book.org/data/karate.csv&lt;/a&gt;&lt;/p&gt;'><sup>26</sup></a>, and check the first few rows.</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get karate edgelist data as dataframe</span></span>
<span><span class="va">karate_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/karate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">karate_edgelist</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    from      to
## 1 Mr Hi Actor 2
## 2 Mr Hi Actor 3
## 3 Mr Hi Actor 4
## 4 Mr Hi Actor 5
## 5 Mr Hi Actor 6
## 6 Mr Hi Actor 7</code></pre>
<p>Now let’s use our edgelist to create an undirected graph object in <code>igraph</code>.</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">karate</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="va">karate_edgelist</span>, </span>
<span>                                         directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## IGRAPH 3e82c01 UN-- 34 78 -- 
## + attr: name (v/c)
## + edges from 3e82c01 (vertex names):
##  [1] Mr Hi   --Actor 2  Mr Hi   --Actor 3  Mr Hi   --Actor 4  Mr Hi   --Actor 5  Mr Hi   --Actor 6 
##  [6] Mr Hi   --Actor 7  Mr Hi   --Actor 8  Mr Hi   --Actor 9  Mr Hi   --Actor 11 Mr Hi   --Actor 12
## [11] Mr Hi   --Actor 13 Mr Hi   --Actor 14 Mr Hi   --Actor 18 Mr Hi   --Actor 20 Mr Hi   --Actor 22
## [16] Mr Hi   --Actor 32 Actor 2 --Actor 3  Actor 2 --Actor 4  Actor 2 --Actor 8  Actor 2 --Actor 14
## [21] Actor 2 --Actor 18 Actor 2 --Actor 20 Actor 2 --Actor 22 Actor 2 --Actor 31 Actor 3 --Actor 4 
## [26] Actor 3 --Actor 8  Actor 3 --Actor 9  Actor 3 --Actor 10 Actor 3 --Actor 14 Actor 3 --Actor 28
## [31] Actor 3 --Actor 29 Actor 3 --Actor 33 Actor 4 --Actor 8  Actor 4 --Actor 13 Actor 4 --Actor 14
## [36] Actor 5 --Actor 7  Actor 5 --Actor 11 Actor 6 --Actor 7  Actor 6 --Actor 11 Actor 6 --Actor 17
## + ... omitted several edges</code></pre>
<p>We can see that we have an undirected graph with 34 named vertices and 78 edges.</p>
<div id="native-plotting-igraph" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Native plotting in <code>igraph</code><a class="anchor" aria-label="anchor" href="#native-plotting-igraph"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>igraph</code> package allows simple plotting of graphs using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function. The function works instantly with an <code>igraph</code> object, using default values for its various arguments. As a starting point, we will use all of the default values except for the layout of the graph. We will set the layout of the plot initially to be a random layout, which will randomly allocate the vertices to different positions. Figure <a href="viz-graphs.html#fig:basic-karate">3.2</a> shows this default plot for our <code>karate</code> network.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create random layout</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_randomly.html">layout_randomly</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot with random layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">l</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:basic-karate"></span>
<img src="_main_files/figure-html/basic-karate-1.png" alt="Basic default plot of `karate` network" width="90%"><p class="caption">
Figure 3.2: Basic default plot of <code>karate</code> network
</p>
</div>
<div class="thinkahead">
<p><strong>Playing around:</strong> The previous code chunk fixes the positioning of the vertices on our <code>karate</code> graph. By setting a random seed, we can ensure the same random numbers are generated each time so that this precise plot is repeatable and reproducible. Then the <code><a href="https://rdrr.io/pkg/igraph/man/layout_randomly.html">layout_randomly()</a></code> function calculates random x and y coordinates for the vertices, and when we use it in the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function, it assigns those coordinates in the plot. As we learn about layouts later in the chapter, we will use this technique a lot. If you like, try playing around with other layouts now. A couple of examples are <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_sugiyama.html">layout_with_sugiyama()</a></code> and <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_dh.html">layout_with_dh()</a></code>. Remember to always set the same seed whenever you generate a graph layout calculation to ensure that your visualization in reproducible by yourself or others.</p>
</div>
<p>Looking at Figure <a href="viz-graphs.html#fig:basic-karate">3.2</a>, we note that the labeling of the vertices is somewhat obtrusive and unhelpful to the clarity of the graph. This will be a common problem with default graph plotting, and with a large number of vertices the plot can easily turn into a messy cloud of overlapping labels.</p>
<p>Vertex labels can be adjusted via properties of the vertices. The most common properties adjusted are as follows:</p>
<ul>
<li>
<code>label</code>: The text of the label</li>
<li>
<code>label.family</code>: The font family to be used (default is ‘serif’)</li>
<li>
<code>label.font</code>: The font style, where 1 is plain (default), 2 is bold, 3 is italic, 4 is bold and italic and 5 is symbol font</li>
<li>
<code>label.cex</code>: The size of the label text</li>
<li>
<code>label.color</code>: The color of the label text</li>
<li>
<code>label.dist</code>: The distance of the label from the vertex, where 0 is centered on the vertex (default) and 1 is beside the vertex</li>
<li>
<code>label.degree</code>: The angle at which the label will display relative to the center of the vertex, in radians. The default is <code>-pi/4</code>
</li>
</ul>
<p>Let’s try to change the vertex labels so that they only display for Mr Hi and for John A. Let’s also change the size, color and font family of the labels. The output can be seen in Figure <a href="viz-graphs.html#fig:change-vlabels-karate">3.3</a>.</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># only store a label if Mr Hi or John A</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,</span>
<span>                          <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change label font color, size and font family </span></span>
<span><span class="co"># (selected font family needs to be installed on system)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">label.color</span> <span class="op">&lt;-</span> <span class="st">"black"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">label.cex</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">label.family</span> <span class="op">&lt;-</span> <span class="st">"arial"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">l</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:change-vlabels-karate"></span>
<img src="_main_files/figure-html/change-vlabels-karate-1.png" alt="Adjusting label appearance through changing vertex properties" width="90%"><p class="caption">
Figure 3.3: Adjusting label appearance through changing vertex properties
</p>
</div>
<p>Now that we have cleaned up the label situation, we may wish to change the appearance of the vertices. Here are the most commonly used vertex properties which allow this:</p>
<ul>
<li>
<code>size</code>: The size of the vertex</li>
<li>
<code>color</code>: The fill color of the vertex</li>
<li>
<code>frame.color</code>: The border color of the vertex</li>
<li>
<code>shape</code>: The shape of the vertex; multiple shape options are supported including <code>circle</code>, <code>square</code>, <code>rectangle</code> and <code>none</code>
</li>
</ul>
<p>We may wish to use different vertex shapes and colors for our actors compared to Mr Hi and John A. This is how this would be done, with the results in Figure <a href="viz-graphs.html#fig:change-vertices-karate">3.4</a>.</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># different colors and shapes for Mr Hi and and John A</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>,</span>
<span>                          <span class="st">"lightblue"</span>, </span>
<span>                          <span class="st">"pink"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>,</span>
<span>                          <span class="st">"square"</span>, </span>
<span>                          <span class="st">"circle"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">l</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:change-vertices-karate"></span>
<img src="_main_files/figure-html/change-vertices-karate-1.png" alt="Adjusting vertex appearance through changing vertex properties" width="90%"><p class="caption">
Figure 3.4: Adjusting vertex appearance through changing vertex properties
</p>
</div>
<p>In a similar way, edges can be changed through adding or editing edge properties. Here are some common edge properties that are used to change the edges in an <code>igraph</code> plot:</p>
<ul>
<li>
<code>color</code>: The color of the edge</li>
<li>
<code>width</code>: The width of the edge</li>
<li>
<code>arrow.size</code>: The size of the arrow in a directed edge</li>
<li>
<code>arrow.width</code>: The width of the arrow in a directed edge</li>
<li>
<code>arrow.mode</code>: Whether edges should direct forward (<code>&gt;</code>), backward (<code>&lt;</code>) or both (<code>&lt;&gt;</code>)</li>
<li>
<code>lty</code>: Line type of edges, with numerous options including <code>solid</code>, <code>dashed</code>, <code>dotted</code>, <code>dotdash</code> and <code>blank</code>
</li>
<li>
<code>curved</code>: The amount of curvature to apply to the edge, with zero (default) as a straight edge, negative numbers bending clockwise and positive bending anti-clockwise</li>
</ul>
<p>Note that edges, like vertices, can also have a <code>label</code> property and various label settings like <code>label.cex</code> and <code>label.family</code>. Let’s adjust our <code>karate</code> graph to have blue dashed edges, with the result in Figure <a href="viz-graphs.html#fig:change-edges-karate">3.5</a>.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change color and linetype of all edges</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"blue"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">lty</span> <span class="op">&lt;-</span> <span class="st">"dashed"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">l</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:change-edges-karate"></span>
<img src="_main_files/figure-html/change-edges-karate-1.png" alt="Adjusting edge appearance through changing edge properties" width="90%"><p class="caption">
Figure 3.5: Adjusting edge appearance through changing edge properties
</p>
</div>
<div class="thinkahead">
<p><strong>Playing around:</strong> Usually, getting your graph looking the way you want takes some trial and error and some playing around with its properties. Try further adjusting the <code>karate</code> graph using some of the other properties listed.</p>
</div>
</div>
<div id="layouts" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Graph layouts<a class="anchor" aria-label="anchor" href="#layouts"><i class="fas fa-link"></i></a>
</h3>
<p>The layout of a graph determines the precise position of its vertices on a 2-dimensional plane or in 3-dimensional space. Layouts are themselves algorithms that calculate vertex positions based on properties of the graph. Different layouts work for different purposes, for example to visually identify communities in a graph, or just to make the graph look pleasant. In Section <a href="viz-graphs.html#native-plotting-igraph">3.1.1</a>, we used a random layout for our <code>karate</code> graph. Now let’s look at common alternative layouts. Layouts are used by multiple plotting packages, but we will explore them using <code>igraph</code> base plotting capabilities here.</p>
<p>There are two ways to add a layout to a graph in <code>igraph</code>. If you want to keep the graph object separate from the layout, you can create the layout and use it as an argument in the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function, like we did for Figure <a href="viz-graphs.html#fig:basic-karate">3.2</a>. Alternatively, you can assign a layout to a graph object by making it a property of the graph. You should only do this if you intend to stick permanently with your chosen layout and do not intend to experiment. You can use the <code><a href="https://rdrr.io/pkg/igraph/man/add_layout_.html">add_layout_()</a></code> function to achieve this. For example, this would create a <code>karate</code> graph with a grid layout.</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check whether existing karate graph has a layout property</span></span>
<span><span class="va">karate</span><span class="op">$</span><span class="va">layout</span></span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assign grid layout as a graph property</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">karate_grid</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/add_layout_.html">add_layout_</a></span><span class="op">(</span><span class="va">karate</span>, <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_on_grid.html">on_grid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check a few lines of the 'layout' property</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">karate_grid</span><span class="op">$</span><span class="va">layout</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0
## [2,]    1    0
## [3,]    2    0
## [4,]    3    0
## [5,]    4    0
## [6,]    5    0</code></pre>
<p>We can see that our new graph object has a layout property. Note that running <code><a href="https://rdrr.io/pkg/igraph/man/add_layout_.html">add_layout_()</a></code> on a graph that already has a layout property will by default overwrite the previous layout unless you set the argument <code>overwrite = FALSE</code>.</p>
<p>As well as the random layout demonstrated in Figure <a href="viz-graphs.html#fig:basic-karate">3.2</a>, common shape layouts include <code><a href="https://rdrr.io/pkg/igraph/man/layout_as_star.html">as_star()</a></code>, <code><a href="https://rdrr.io/pkg/igraph/man/layout_as_tree.html">as_tree()</a></code>, <code><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle()</a></code>, <code><a href="https://rdrr.io/pkg/igraph/man/layout_on_grid.html">on_grid()</a></code> and <code><a href="https://rdrr.io/pkg/igraph/man/layout_on_sphere.html">on_sphere()</a></code>. For example, Figure <a href="viz-graphs.html#fig:circle-karate">3.6</a> shows the circle layout for our <code>karate</code> network, and Figure <a href="viz-graphs.html#fig:sphere-karate">3.7</a> shows the sphere layout.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># circle layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">circ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">layout_in_circle</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">circ</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:circle-karate"></span>
<img src="_main_files/figure-html/circle-karate-1.png" alt="Circle layout of the `karate` graph" width="90%"><p class="caption">
Figure 3.6: Circle layout of the <code>karate</code> graph
</p>
</div>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sphere layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_on_sphere.html">layout_on_sphere</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">sph</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sphere-karate"></span>
<img src="_main_files/figure-html/sphere-karate-1.png" alt="Sphere layout of the `karate` graph" width="90%"><p class="caption">
Figure 3.7: Sphere layout of the <code>karate</code> graph
</p>
</div>
<div class="thinkahead">
<p><strong>Thinking ahead:</strong> Notice how the circle and sphere layouts position Mr Hi and John A very close to each other. This is an indication that the layout algorithms have established something in common between these two individuals based on the properties of the graph. This is something we will cover in a later chapter, but if you want to explore ahead, and you know how to, calculate some centrality measures for the vertices in the <code>karate</code> graph—for example degree centrality and betweenness centrality.</p>
</div>
<p><em>Force-directed</em> graph layouts are extremely popular, as they are aesthetically pleasing and they help visualize communities of vertices quite effectively, especially in graphs with low to moderate edge complexity. These algorithms emulate physical models like Hooke’s law to attract connected vertices together, at the same time applying repelling forces to all pairs of vertices to try to keep as much space as possible between them. This calculation is an iterative process where vertex positions are calculated again and again until equilibrium is reached<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Note that this means that the process is usually computationally expensive on large graphs and can easily freeze up your machine if you are not careful.&lt;/p&gt;"><sup>27</sup></a>. The result is usually a layout where connected vertices are closer together and where edge lengths are approximately equal.</p>
<p>For Zachary’s Karate Club study, which was a study of connection and community, we can imagine that a force-directed layout would be a good choice of visualization, and we will find that this is the case for many other network graphs we study. There are several different implementations of force-directed algorithms available. Perhaps the most popular of these is the Fruchterman-Reingold algorithm. Figure <a href="viz-graphs.html#fig:fr-karate">3.8</a> shows our <code>karate</code> network with the layout generated by the Fruchterman-Reingold algorithm, and we can see clear communities in the karate club oriented around Mr Hi and John A.</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># F-R algorithm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">layout_with_fr</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">fr</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fr-karate"></span>
<img src="_main_files/figure-html/fr-karate-1.png" alt="Force-directed layout of the `karate` graph according to the Fruchterman-Reingold algorithm" width="90%"><p class="caption">
Figure 3.8: Force-directed layout of the <code>karate</code> graph according to the Fruchterman-Reingold algorithm
</p>
</div>
<p>The Kamada-Kawai algorithm and the GEM algorithm are also commonly used force-directed algorithms and they produce similar types of community structures as in Figures <a href="viz-graphs.html#fig:kk-karate">3.9</a> and <a href="viz-graphs.html#fig:gem-karate">3.10</a>, respectively.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># K-K algorithm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">kk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_kk.html">layout_with_kk</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">kk</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:kk-karate"></span>
<img src="_main_files/figure-html/kk-karate-1.png" alt="Force-directed layout of the `karate` graph according to the Kamada-Kawai algorithm" width="90%"><p class="caption">
Figure 3.9: Force-directed layout of the <code>karate</code> graph according to the Kamada-Kawai algorithm
</p>
</div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GEM algorithm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">gem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_gem.html">layout_with_gem</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="va">gem</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gem-karate"></span>
<img src="_main_files/figure-html/gem-karate-1.png" alt="Force-directed layout of the `karate` graph according to the GEM algorithm" width="90%"><p class="caption">
Figure 3.10: Force-directed layout of the <code>karate</code> graph according to the GEM algorithm
</p>
</div>
<p>As well as force-directed and shape-oriented layout algorithms, several alternative approaches to layout calculations are also available. <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_dh.html">layout_with_dh()</a></code> uses a simulated annealing algorithm developed for nice graph drawing, and <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_mds.html">layout_with_mds()</a></code> generates vertex coordinates through multidimensional scaling based on shortest path distance (which we will look at in a later chapter). <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_sugiyama.html">layout_with_sugiyama()</a></code> is suitable for directed graphs and minimizes edge crossings by introducing bends on edges<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The multigraph visualization in Figure &lt;a href="working.html#fig:gmulti"&gt;2.4&lt;/a&gt; was generated using the Sugiyama layout algorithm.&lt;/p&gt;'><sup>28</sup></a>.</p>
<p>Finally, there are three layout algorithms that are suited for large graphs with many thousands or even millions of edges. One of the biggest problems with visualizing large graphs is the potential for ‘hairballs’—that is, clumps of connected nodes that are so dense they cannot be usefully visualized. <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_lgl.html">layout_with_lgl()</a></code> uses the Large Graph Layout algorithm which tries to identify clusters of vertices and position the clusters before positioning the individual vertices to minimize the chance of hairballs, while still adhering to the principles of force-directed networks. <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_drl.html">layout_with_drl()</a></code> and <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_graphopt.html">layout_with_graphopt()</a></code> also use efficient force-directed algorithms which scale well on large graphs.</p>
<div class="thinkahead">
<p><strong>Playing around:</strong> Try laying out the <code>karate</code> graph using these various algorithms and observe the different appearances. If you are interested in experimenting with a larger graph, and you have enough computing power that it won’t freeze your machine, load the <code>wikivote</code> edgelist from the <code>onadata</code> package, or download it from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/wikivote.csv" class="uri"&gt;https://ona-book.org/data/wikivote.csv&lt;/a&gt;&lt;/p&gt;'><sup>29</sup></a>. This network represents votes from Wikipedia members for other members to be made administrators. Create a directed graph object, and lay it out using <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_graphopt.html">layout_with_graphopt()</a></code>. To help with your visualization, remove the vertex labels, set the node size to 0.5 and set the edge arrow size to 0.1. When you plot this, you should see a great example of a hairball, as in Figure <a href="viz-graphs.html#fig:hairball-example">3.11</a>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hairball-example"></span>
<img src="www/visualizing-graphs/hairball.png" alt="Example of a hairball generated by trying to visualize a large network of Wikipedia votes for administrators" width="80%"><p class="caption">
Figure 3.11: Example of a hairball generated by trying to visualize a large network of Wikipedia votes for administrators
</p>
</div>
<p>In the absence of any information on layout, the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function in <code>igraph</code> will choose an appropriate layout using a logic determined by <code><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html">layout_nicely()</a></code>. If the graph already has a <code>layout</code> attribute, it will use this layout. Otherwise, if the vertices have <code>x</code> and <code>y</code> attributes, it will use these as vertex coordinates. Failing both of these, <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">layout_with_fr()</a></code> will be used if the graph has fewer than 1,000 vertices, and <code><a href="https://rdrr.io/pkg/igraph/man/layout_with_drl.html">layout_with_drl()</a></code> will be used if the graph has more than 1,000 vertices. Thus, the plot defaults to a form of force-directed layout unless the graph attributes suggest otherwise.</p>
</div>
<div id="ggraph" class="section level3" number="3.1.3">
<h3>
<span class="header-section-number">3.1.3</span> Static plotting with <code>ggraph</code><a class="anchor" aria-label="anchor" href="#ggraph"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>ggraph</code> package is developed for those who enjoy working with the more general <code>ggplot2</code> package, which is a very popular plotting package in R<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;To learn &lt;code&gt;ggplot2&lt;/code&gt; as a foundational package, &lt;span class="citation"&gt;Wickham (&lt;a href="references.html#ref-ggplot2"&gt;2016&lt;/a&gt;)&lt;/span&gt; is highly recommended.&lt;/p&gt;'><sup>30</sup></a>. As with <code>ggplot2</code>, <code>ggraph</code> provides a grammar for building graph visualizations. While the native capabilities of <code>igraph</code> will suffice in R for most static graph visualizations, <code>ggraph</code> could be considered an additional option for those who prefer to use it. It also integrates well with <code>ggplot2</code> which allows further layers to be added to the graph visualization, such as a greater variety of node shapes and the ability to layer networks onto geographic maps with relative ease.</p>
<p>To build an elementary graph using <code>ggraph</code>, we start with an <code>igraph</code> object and a layout, and we then progressively add node and edge properties as well as themes and other layers if required. To illustrate, let’s generate a relatively basic visualization of our <code>karate</code> graph using <code>ggraph</code> as in Figure <a href="viz-graphs.html#fig:ggraph-basic-karate">3.12</a>. Note that it is customary to add the edges before the vertices so that the vertices are the top layer in the plot.</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get karate edgelist</span></span>
<span><span class="va">karate_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/karate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create graph object</span></span>
<span><span class="va">karate</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="va">karate_edgelist</span>, </span>
<span>                                        directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualise using ggraph with fr layout</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ggraph-basic-karate"></span>
<img src="_main_files/figure-html/ggraph-basic-karate-1.png" alt="Elementary visualization of `karate` graph using `ggraph` and the Fruchterman-Reingold algorithm" width="90%"><p class="caption">
Figure 3.12: Elementary visualization of <code>karate</code> graph using <code>ggraph</code> and the Fruchterman-Reingold algorithm
</p>
</div>
<p>This is not particularly appealing. However, we can play with properties to improve the appearance, and we can move to a minimal theme to remove the grey background and add a title if we wish, as in Figure <a href="viz-graphs.html#fig:ggraph-nicer-karate">3.13</a>.</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Zachary's Karate Club Network"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ggraph-nicer-karate"></span>
<img src="_main_files/figure-html/ggraph-nicer-karate-1.png" alt="Improved visualization of `karate` graph using node and edge geom functions" width="90%"><p class="caption">
Figure 3.13: Improved visualization of <code>karate</code> graph using node and edge geom functions
</p>
</div>
<p>Like in <code>ggplot2</code>, if we want to associate a property of the nodes or edges with a property of the plot, we can use aesthetic mappings. For example, let’s give Mr Hi and John A the property of “leader” in our graph, and then ask <code>ggraph</code> to color the nodes by this property, as in Figure <a href="viz-graphs.html#fig:ggraph-leader-karate">3.14</a>.</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">leader</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">leader</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                  show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Zachary's Karate Club Network"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ggraph-leader-karate"></span>
<img src="_main_files/figure-html/ggraph-leader-karate-1.png" alt="`karate` graph with `leader` property used as an aesthetic" width="90%"><p class="caption">
Figure 3.14: <code>karate</code> graph with <code>leader</code> property used as an aesthetic
</p>
</div>
<p>As a further example of using <code>ggraph</code>, let’s look at a data set collected during a study of workplace interactions in France in 2015<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="citation"&gt;Génois &amp;amp; Barrat (&lt;a href="references.html#ref-Genois2018"&gt;2018&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;'><sup>31</sup></a>. Load the <code>workfrance_edgelist</code> and <code>workfrance_vertices</code> data sets from the <code>onadata</code> package or download them from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/workfrance_edgelist.csv" class="uri"&gt;https://ona-book.org/data/workfrance_edgelist.csv&lt;/a&gt; and &lt;a href="https://ona-book.org/data/workfrance_vertices.csv" class="uri"&gt;https://ona-book.org/data/workfrance_vertices.csv&lt;/a&gt;&lt;/p&gt;'><sup>32</sup></a>. In this study, employees of a company wore wearable devices to triangulate their location in the building, and edges were defined as any situation where two employees were sharing the same spatial location. The edgelist contains <code>from</code> and <code>to</code> columns for the edges, as well as a <code>mins</code> column representing the total minutes spent co-located during the study<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This data set has been further processed from the original data set, including limiting the edges to those where the total co-location time was at least 5 minutes.&lt;/p&gt;"><sup>33</sup></a>. The vertex list contains ground-truth data on the department of each employee. We will create a basic visualization of this using <code>ggraph</code> in Figure <a href="viz-graphs.html#fig:workfrance-basic">3.15</a>.</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get edgelist with mins property</span></span>
<span><span class="va">workfrance_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://ona-book.org/data/workfrance_edgelist.csv"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get vertex set with dept property</span></span>
<span><span class="va">workfrance_vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://ona-book.org/data/workfrance_vertices.csv"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create undirected graph object</span></span>
<span><span class="va">workfrance</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="va">workfrance_edgelist</span>,</span>
<span>  vertices <span class="op">=</span> <span class="va">workfrance_vertices</span>,</span>
<span>  directed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># basic visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">workfrance</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:workfrance-basic"></span>
<img src="_main_files/figure-html/workfrance-basic-1.png" alt="Connection of employees in a workplace as measured by spatial co-location" width="90%"><p class="caption">
Figure 3.15: Connection of employees in a workplace as measured by spatial co-location
</p>
</div>
<p>As it stands, this graph does not tell us much, but a couple of simple adjustments can change this. First, we can adjust the thickness of the edges to reflect the total number of minutes spent meeting, which seems a reasonable measure of the ‘strength’ or ‘weight’ of the connection. Second, we can color code the nodes by their department. The result is Figure <a href="viz-graphs.html#fig:workfrance-additional">3.16</a>. We can now see clusters of highly connected employees mostly driven by their department.</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">workfrance</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">mins</span><span class="op">)</span>, </span>
<span>                 show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">dept</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Department"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Spatial co-location of employees in a workplace"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:workfrance-additional"></span>
<img src="_main_files/figure-html/workfrance-additional-1.png" alt="Connection of employees in a workplace with edge thickness weighted by minutes spent spatially co-located and vertices colored by department" width="90%"><p class="caption">
Figure 3.16: Connection of employees in a workplace with edge thickness weighted by minutes spent spatially co-located and vertices colored by department
</p>
</div>
<div class="thinkahead">
<p><strong>Thinking ahead:</strong> The graph we have just created in Figure <a href="viz-graphs.html#fig:workfrance-additional">3.16</a> shows how we have detected a community partition of our vertices. It’s relatively clear that individuals in the same department are more likely to be connected. Community detection is an important topic in Organizational Network Analysis which we will study later in this book. It’s not always straightforward to identify drivers of community in networks, but we will learn about a number of unsupervised community detection algorithms which will partition the graph into different community groups. As an example, Figure <a href="viz-graphs.html#fig:workfrance-louvain">3.17</a> shows the results of running the Louvain community detection algorithm on the <code>workfrance</code> graph with <code>mins</code> as the edge weights. You can see that the communities detected are strongly aligned with the departments in Figure <a href="viz-graphs.html#fig:workfrance-additional">3.16</a>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:workfrance-louvain"></span>
<img src="_main_files/figure-html/workfrance-louvain-1.png" alt="Clusters of employees as detected by the Louvain unsupervised community detection algorithm.  Note the cluster similarity of communities with the departments in the previous graph." width="90%"><p class="caption">
Figure 3.17: Clusters of employees as detected by the Louvain unsupervised community detection algorithm. Note the cluster similarity of communities with the departments in the previous graph.
</p>
</div>
<p><code>ggraph</code> visualizations can work relatively easily with other graphics layers, allowing you to superimpose a graph onto other coordinate systems. Let’s look at an example of this at work. Load the <code>londontube_edgelist</code> and <code>londontube_vertices</code> data sets from the <code>onadata</code> package or download them from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/londontube_edgelist.csv" class="uri"&gt;https://ona-book.org/data/londontube_edgelist.csv&lt;/a&gt; and &lt;a href="https://ona-book.org/data/londontube_vertices.csv" class="uri"&gt;https://ona-book.org/data/londontube_vertices.csv&lt;/a&gt;&lt;/p&gt;'><sup>34</sup></a>. The vertex set is a list of London Tube Stations with an <code>id</code>, <code>name</code> and geographical coordinates <code>longitude</code> and <code>latitude</code>.</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download and view london tube vertex data</span></span>
<span><span class="va">londontube_vertices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://ona-book.org/data/londontube_vertices.csv"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">londontube_vertices</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   id         name latitude longitude
## 1  1   Acton Town  51.5028   -0.2801
## 2  2      Aldgate  51.5143   -0.0755
## 3  3 Aldgate East  51.5154   -0.0726
## 4  4   All Saints  51.5107   -0.0130
## 5  5     Alperton  51.5407   -0.2997
## 6  7        Angel  51.5322   -0.1058</code></pre>
<p>The edge list represents <code>from</code> and <code>to</code> connections between stations, along with the name of the <code>line</code> and its official <code>linecolor</code> in hex code.</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download and view london tube edge data</span></span>
<span><span class="va">londontube_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://ona-book.org/data/londontube_edgelist.csv"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">londontube_edgelist</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   from  to          line linecolor
## 1   11 163 Bakerloo Line   #AE6017
## 2   11 212 Bakerloo Line   #AE6017
## 3   49  87 Bakerloo Line   #AE6017
## 4   49 197 Bakerloo Line   #AE6017
## 5   82 163 Bakerloo Line   #AE6017
## 6   82 193 Bakerloo Line   #AE6017</code></pre>
<p>We can easily create an <code>igraph</code> object from this data and then use <code>ggraph</code> to create a visualization using the <code>linecolor</code> as the edge color between stations, as in Figure <a href="viz-graphs.html#fig:non-geo-tube">3.18</a>.</p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a set of distinct line names and linecolors to use</span></span>
<span><span class="va">lines</span> <span class="op">&lt;-</span> <span class="va">londontube_edgelist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">line</span>, <span class="va">linecolor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create graph object</span></span>
<span><span class="va">tubegraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="va">londontube_edgelist</span>, </span>
<span>  vertices <span class="op">=</span> <span class="va">londontube_vertices</span>,</span>
<span>  directed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize tube graph using linecolors for edge color</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">tubegraph</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">line</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_colour.html">scale_edge_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Line"</span>,</span>
<span>                          values <span class="op">=</span> <span class="va">lines</span><span class="op">$</span><span class="va">linecolor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:non-geo-tube"></span>
<img src="_main_files/figure-html/non-geo-tube-1.png" alt="Random graph visualization of the London Tube network graph with the edges colored by the different lines" width="90%"><p class="caption">
Figure 3.18: Random graph visualization of the London Tube network graph with the edges colored by the different lines
</p>
</div>
<p>While it’s great that we can do this so easily, it’s a pretty confusing visualization for anyone who knows London. The Circle Line doesn’t look very circular, the Picadilly Line seems to he heading southeast instead of northeast. In the west, the Metropolitan and Picadilly Lines seem to have swapped places. Of course, this graph is not using geographical coordinates to plot its vertices.</p>
<p>We can change this by expanding our edgelist to include the latitudes and longitudes of the <code>from</code> and <code>to</code> stations in each edge, and then we can layer a map on this graph. First, let’s create those new longitude and latitude columns in the edgelist, and check that it works.</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reorganize to include longitude and latitude for start and end</span></span>
<span><span class="va">new_edgelist</span> <span class="op">&lt;-</span> <span class="va">londontube_edgelist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">londontube_vertices</span> <span class="op">|&gt;</span> </span>
<span>                      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span>, </span>
<span>                    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"from"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>lat_from <span class="op">=</span> <span class="va">latitude</span>, lon_from <span class="op">=</span> <span class="va">longitude</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">londontube_vertices</span> <span class="op">|&gt;</span> </span>
<span>                      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span>, </span>
<span>                    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"to"</span> <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>lat_to <span class="op">=</span> <span class="va">latitude</span>, lon_to <span class="op">=</span> <span class="va">longitude</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">new_edgelist</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   from  to          line linecolor lat_from lon_from  lat_to  lon_to
## 1   11 163 Bakerloo Line   #AE6017  51.5226  -0.1571 51.5225 -0.1631
## 2   11 212 Bakerloo Line   #AE6017  51.5226  -0.1571 51.5234 -0.1466
## 3   49  87 Bakerloo Line   #AE6017  51.5080  -0.1247 51.5074 -0.1223
## 4   49 197 Bakerloo Line   #AE6017  51.5080  -0.1247 51.5098 -0.1342
## 5   82 163 Bakerloo Line   #AE6017  51.5199  -0.1679 51.5225 -0.1631
## 6   82 193 Bakerloo Line   #AE6017  51.5199  -0.1679 51.5154 -0.1755</code></pre>
<p>That looks like it worked. Now we can use the <code>ggmap</code> package in R to layer a map of London on top of the base <code>ggraph</code> layer, and then use the various latitude and longitude columns to make our network geographically accurate, as in Figure <a href="viz-graphs.html#fig:geo-accurate-tube">3.19</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;A Google Maps API key is needed to use &lt;code&gt;ggmap&lt;/code&gt; - see &lt;a href="https://github.com/dkahle/ggmap" class="uri"&gt;https://github.com/dkahle/ggmap&lt;/a&gt; for more information.&lt;/p&gt;'><sup>35</sup></a>.</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># recreate graph object to capture additional edge data</span></span>
<span><span class="va">tubegraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="va">new_edgelist</span>, </span>
<span>  vertices <span class="op">=</span> <span class="va">londontube_vertices</span>,</span>
<span>  directed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># layer a London map (requires Google Maps API key)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dkahle/ggmap">ggmap</a></span><span class="op">)</span></span>
<span><span class="va">londonmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/get_map.html">get_map</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"London, UK"</span>, source <span class="op">=</span> <span class="st">"google"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize using geolocation</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">tubegraph</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_blank.html">geom_blank</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/inset_raster.html">inset_ggmap</a></span><span class="op">(</span><span class="va">londonmap</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">longitude</span>, y <span class="op">=</span> <span class="va">latitude</span><span class="op">)</span>, </span>
<span>                  color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon_from</span>, y <span class="op">=</span> <span class="va">lat_from</span>,</span>
<span>                     xend <span class="op">=</span> <span class="va">lon_to</span>, yend <span class="op">=</span> <span class="va">lat_to</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">line</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_colour.html">scale_edge_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Line"</span>,</span>
<span>                          values <span class="op">=</span> <span class="va">lines</span><span class="op">$</span><span class="va">linecolor</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:geo-accurate-tube"></span>
<img src="_main_files/figure-html/geo-accurate-tube-1.png" alt="Geographically accurate London Tube network" width="90%"><p class="caption">
Figure 3.19: Geographically accurate London Tube network
</p>
</div>
<p>In Figure <a href="viz-graphs.html#fig:geo-accurate-tube">3.19</a>, it looks like everything is in the right place. This kind of graphical layering can be extremely important when there is an inherent coordinate system lying behind the vertices of your graph and where none of the existing layout algorithms can recreate that coordinate system.</p>
</div>
<div id="interactive-graph-visualization-using-visnetwork" class="section level3" number="3.1.4">
<h3>
<span class="header-section-number">3.1.4</span> Interactive graph visualization using <code>visNetwork</code><a class="anchor" aria-label="anchor" href="#interactive-graph-visualization-using-visnetwork"><i class="fas fa-link"></i></a>
</h3>
<p>We have seen earlier how many large networks are too complicated to make sense of visually using static approaches like those we have already reviewed in <code>igraph</code> or <code>ggraph</code>. Nevertheless, interactive visualizations of networks can be useful where there is an interest in visual exploration of particular vertices or small subnetworks, even when the overall network is visually complex. We will touch upon a couple of commonly used interactive graph visualization packages here, all of which use Javascript libraries behind the scenes to create the interactive visualizations.</p>
<p><code>visNetwork</code> is a simple but effective package which uses the <code>vis.js</code> API to create HTML widgets containing interactive graph visualizations. It is fairly easy to use, with its main function <code><a href="https://rdrr.io/pkg/visNetwork/man/visNetwork.html">visNetwork()</a></code> taking a dataframe of node information and a dataframe of edge information, as well as a few other optional arguments. The columns in these dataframes are expected to have certain default column names. Vertices/nodes are expected to at least have an <code>id</code> column but can also contain:</p>
<ul>
<li>
<code>label</code>: the label of the vertex</li>
<li>
<code>group</code>: the group of the vertex if there are groups</li>
<li>
<code>value</code>: used to determine the size of the vertex</li>
<li>
<code>title</code>: used as a tooltip on mouseover</li>
<li>Other columns can be included to be passed to specific values/properties in the visualization, such as <code>color</code> or <code>shape</code>.</li>
</ul>
<p>The edge dataframe must contain a <code>from</code> and <code>to</code> column, and can also contain <code>label</code>, <code>value</code> and <code>title</code> to customize the edges as with the vertices, as well as other properties such as <code>arrows</code> or <code>dashes</code>.</p>
<p>Interactive Figure <a href="viz-graphs.html#fig:gwork-visnetwork">3.20</a> is a very simple example of the <code>visNetwork</code> function at work using our <span class="math inline">\(G_\mathrm{work}\)</span> graph from Section <a href="working.html#graph-def">2.1.1</a>. Note that the <code><a href="https://rdrr.io/pkg/visNetwork/man/visLayout.html">visLayout()</a></code> function can be used for various customizations, including passing a random seed variable to <code>vis.js</code> to ensure reproducibility.</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://datastorm-open.github.io/visNetwork/">visNetwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"David"</span>, <span class="st">"Zubin"</span>, <span class="st">"Suraya"</span>, <span class="st">"Jane"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/visNetwork/man/visNetwork.html">visNetwork</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/visNetwork/man/visLayout.html">visLayout</a></span><span class="op">(</span>randomSeed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gwork-visnetwork"></span>
<div id="htmlwidget-d57ecbd3ad10bd2d35a2" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d57ecbd3ad10bd2d35a2">{"x":{"nodes":{"id":[1,2,3,4],"label":["David","Zubin","Suraya","Jane"]},"edges":{"from":[1,1,1,4,4],"to":[2,3,4,2,3]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.20: Simple interactive <code>visNetwork</code> rendering of the <span class="math inline">\(G_\mathrm{work}\)</span> graph. Try playing with this rendering by zooming in/out or moving nodes.
</p>
</div>
<p>In fact, assuming that we are working with <code>igraph</code> objects, the easiest way to deploy <code>visNetwork</code> is to use the <code><a href="https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html">visIgraph()</a></code> function, which takes an <code>igraph</code> object and restructures it behind the scenes to use the <code>vis.js</code> API, even inheriting whatever <code>igraph</code> layout you prefer. Let’s recreate our <code>karate</code> graph in <code>visNetwork</code>, as in Interactive Figure <a href="viz-graphs.html#fig:karate-visnetwork">3.21</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Note that if you are passing an &lt;code&gt;igraph&lt;/code&gt; layout to &lt;code&gt;visNetwork&lt;/code&gt;, you will need to use the &lt;code&gt;randomSeed&lt;/code&gt; argument directly in the &lt;code&gt;visIgraph()&lt;/code&gt; function.&lt;/p&gt;"><sup>36</sup></a>.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get karate edgelist</span></span>
<span><span class="va">karate_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/karate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create graph object</span></span>
<span><span class="va">karate</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="va">karate_edgelist</span>, </span>
<span>                                        directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># different colors and shapes for Mr Hi and and John A</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>,</span>
<span>                          <span class="st">"lightblue"</span>, </span>
<span>                          <span class="st">"pink"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>,</span>
<span>                          <span class="st">"square"</span>, </span>
<span>                          <span class="st">"circle"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># more visible edges </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">=</span> <span class="st">"grey"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># visualize from igraph</span></span>
<span><span class="fu">visNetwork</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html">visIgraph</a></span><span class="op">(</span><span class="va">karate</span>, layout <span class="op">=</span> <span class="st">"layout_with_fr"</span>, </span>
<span>                      randomSeed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:karate-visnetwork"></span>
<div id="htmlwidget-e76df25d4e1770d66a86" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e76df25d4e1770d66a86">{"x":{"nodes":{"id":["Mr Hi","Actor 2","Actor 3","Actor 4","Actor 5","Actor 6","Actor 7","Actor 9","Actor 10","Actor 14","Actor 15","Actor 16","Actor 19","Actor 20","Actor 21","Actor 23","Actor 24","Actor 25","Actor 26","Actor 27","Actor 28","Actor 29","Actor 30","Actor 31","Actor 32","Actor 33","Actor 8","Actor 11","Actor 12","Actor 13","Actor 18","Actor 22","Actor 17","John A"],"color":["lightblue","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","lightblue"],"shape":["square","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square"],"label":["Mr Hi","Actor 2","Actor 3","Actor 4","Actor 5","Actor 6","Actor 7","Actor 9","Actor 10","Actor 14","Actor 15","Actor 16","Actor 19","Actor 20","Actor 21","Actor 23","Actor 24","Actor 25","Actor 26","Actor 27","Actor 28","Actor 29","Actor 30","Actor 31","Actor 32","Actor 33","Actor 8","Actor 11","Actor 12","Actor 13","Actor 18","Actor 22","Actor 17","John A"],"x":[0.190687845068345,0.0132877862854588,-0.223134429099049,0.0250193071922982,0.556110756785596,0.699728575164583,0.703543257762113,-0.311180109543968,-0.517479094231182,-0.165645780729725,-0.867012120960171,-0.964326644979945,-0.802058180503033,-0.122989647824225,-0.96854498492282,-0.927366874662782,-0.670531699055899,-0.348627085968283,-0.511806391959486,-1,-0.449016697098456,-0.402542350435914,-0.838201634645628,-0.4087987278348,-0.309414497873656,-0.666559146735384,0.0971672273466904,0.550433139292149,0.413380485469321,0.255872949988716,0.321977448540886,0.347145371185161,1,-0.605668554953779],"y":[-0.213243973366882,-0.450176443356623,-0.275766508053284,-0.749913424759686,-0.209422991961298,-0.0352524907220172,-0.291722959380564,-0.163072229507381,-0.668687137277491,-0.472831066550723,-0.414124705908606,-0.0849551456309654,-0.607338049201286,-0.0235992545040055,-0.310158852587208,0.123859989316732,0.535848874256083,0.99607011845307,1,0.462220480380136,0.45960229597303,0.134334700697694,0.380421342145101,-0.41953791144505,0.374036529850743,-0.0905244335853638,-0.589041190340294,0.108480055292457,0.44073283230466,-1,-0.741735071827429,-0.483319233585932,-0.13933877174475,-0.0426704260189256]},"edges":{"from":["Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Mr Hi","Actor 2","Actor 2","Actor 2","Actor 2","Actor 2","Actor 2","Actor 2","Actor 2","Actor 3","Actor 3","Actor 3","Actor 3","Actor 3","Actor 3","Actor 3","Actor 3","Actor 4","Actor 4","Actor 4","Actor 5","Actor 5","Actor 6","Actor 6","Actor 6","Actor 7","Actor 9","Actor 9","Actor 9","Actor 10","Actor 14","Actor 15","Actor 15","Actor 16","Actor 16","Actor 19","Actor 19","Actor 20","Actor 21","Actor 21","Actor 23","Actor 23","Actor 24","Actor 24","Actor 24","Actor 24","Actor 24","Actor 25","Actor 25","Actor 25","Actor 26","Actor 27","Actor 27","Actor 28","Actor 29","Actor 29","Actor 30","Actor 30","Actor 31","Actor 31","Actor 32","Actor 32","Actor 33"],"to":["Actor 2","Actor 3","Actor 4","Actor 5","Actor 6","Actor 7","Actor 8","Actor 9","Actor 11","Actor 12","Actor 13","Actor 14","Actor 18","Actor 20","Actor 22","Actor 32","Actor 3","Actor 4","Actor 8","Actor 14","Actor 18","Actor 20","Actor 22","Actor 31","Actor 4","Actor 8","Actor 9","Actor 10","Actor 14","Actor 28","Actor 29","Actor 33","Actor 8","Actor 13","Actor 14","Actor 7","Actor 11","Actor 7","Actor 11","Actor 17","Actor 17","Actor 31","Actor 33","John A","John A","John A","Actor 33","John A","Actor 33","John A","Actor 33","John A","John A","Actor 33","John A","Actor 33","John A","Actor 26","Actor 28","Actor 30","Actor 33","John A","Actor 26","Actor 28","Actor 32","Actor 32","Actor 30","John A","John A","Actor 32","John A","Actor 33","John A","Actor 33","John A","Actor 33","John A","John A"],"color":["grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey"],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.21: Interactive <code>visNetwork</code> rendering of the basic <code>karate</code> graph using a force-directed layout
</p>
</div>
<div class="thinkahead">
<p><strong>Playing around:</strong> The <code>visNetwork</code> package allows you to take advantage of a ton of features in the <code>vis.js</code> API, including a wide range of graph customization, and the ability to make your graph editable or to add selector menus to search for specific nodes or groups of nodes. It’s worth experimenting with all its different capabilities. A thorough manual can be found at <a href="https://datastorm-open.github.io/visNetwork/">https://datastorm-open.github.io/visNetwork/</a>. Why don’t you try to recreate the <code>workfrance</code> graph from this chapter in <code>visNetwork</code>?</p>
</div>
</div>
<div id="interactive-graph-visualization-using-networkd3" class="section level3" number="3.1.5">
<h3>
<span class="header-section-number">3.1.5</span> Interactive graph visualization using <code>networkD3</code><a class="anchor" aria-label="anchor" href="#interactive-graph-visualization-using-networkd3"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>networkD3</code> package creates responsive and interactive network visualizations using the <code>D3</code> javascript library, which has some beautiful options for common network layouts like force-directed or chord diagrams.</p>
<p>To create a simple force-directed visualization based on an edgelist, use the <code><a href="https://rdrr.io/pkg/networkD3/man/simpleNetwork.html">simpleNetwork()</a></code> function. All this needs is a simple dataframe where by default the first two columns represent the edgelist<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;You can use the arguments in the &lt;code&gt;simpleNetwork()&lt;/code&gt; function to define the Source and Target columns if they are not the first two columns&lt;/p&gt;"><sup>37</sup></a>. Here is an example for the <code>karate</code> network, with the result shown in Interactive Figure <a href="viz-graphs.html#fig:simple-networkD3">3.22</a>. Note that it is not possible to set a random seed with <code>networkD3</code>.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get karate edgelist</span></span>
<span><span class="va">karate_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/karate.csv"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># visualize</span></span>
<span><span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/simpleNetwork.html">simpleNetwork</a></span><span class="op">(</span><span class="va">karate_edgelist</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:simple-networkD3"></span>
<div id="htmlwidget-dcce969965edfe9f869a" style="width:672px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-dcce969965edfe9f869a">{"x":{"links":{"source":[33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,10,10,10,10,10,10,10,10,21,21,21,21,21,21,21,21,26,26,26,27,27,28,28,28,29,31,31,31,0,4,5,5,6,6,9,9,11,12,12,14,14,15,15,15,15,15,16,16,16,17,18,18,19,20,20,22,22,23,23,24,24,25],"target":[10,21,26,27,28,29,30,31,1,2,3,4,8,11,13,24,21,26,30,4,8,11,13,23,26,30,31,0,4,19,20,25,30,3,4,29,1,29,1,7,7,23,25,32,32,32,25,32,25,32,25,32,32,25,32,25,32,17,19,22,25,32,17,19,24,24,22,32,32,24,32,25,32,25,32,25,32,32],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["Actor 10","Actor 11","Actor 12","Actor 13","Actor 14","Actor 15","Actor 16","Actor 17","Actor 18","Actor 19","Actor 2","Actor 20","Actor 21","Actor 22","Actor 23","Actor 24","Actor 25","Actor 26","Actor 27","Actor 28","Actor 29","Actor 3","Actor 30","Actor 31","Actor 32","Actor 33","Actor 4","Actor 5","Actor 6","Actor 7","Actor 8","Actor 9","John A","Mr Hi"],"group":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.22: Simple interactive <code>networkD3</code> rendering of the Karate graph
</p>
</div>
<p>The <code><a href="https://rdrr.io/pkg/networkD3/man/forceNetwork.html">forceNetwork()</a></code> function allows greater levels of customization of the visualization. This function requires an edgelist and a vertex set in a specific format. However, we can use the function <code><a href="https://rdrr.io/pkg/networkD3/man/igraph_to_networkD3.html">igraph_to_networkD3()</a></code> to easily create a list containing what we need from an <code>igraph</code> object. In the next example, we recreate the graph in Figure <a href="viz-graphs.html#fig:simple-networkD3">3.22</a>, but we put Mr Hi and John A into a different group, with the result shown in Interactive Figure <a href="viz-graphs.html#fig:force-networkD3">3.23</a>. Note that node names only appear when nodes are clicked.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get karate edgelist</span></span>
<span><span class="va">karate_edgelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://ona-book.org/data/karate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create igraph object</span></span>
<span><span class="va">karate</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="va">karate_edgelist</span>, </span>
<span>                                        directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># give Mr Hi and John A a different group</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mr Hi"</span>, <span class="st">"John A"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># translate to networkD3 - creates a list with links and nodes dfs</span></span>
<span><span class="co"># links have a source and target column and group if requested </span></span>
<span><span class="va">netd3_list</span> <span class="op">&lt;-</span> <span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/igraph_to_networkD3.html">igraph_to_networkD3</a></span><span class="op">(</span><span class="va">karate</span>, </span>
<span>                                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">karate</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize</span></span>
<span><span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/forceNetwork.html">forceNetwork</a></span><span class="op">(</span></span>
<span>  Links <span class="op">=</span> <span class="va">netd3_list</span><span class="op">$</span><span class="va">links</span>,</span>
<span>  Nodes <span class="op">=</span> <span class="va">netd3_list</span><span class="op">$</span><span class="va">nodes</span>,</span>
<span>  NodeID <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  Source <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  Target <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>  Group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:force-networkD3"></span>
<div id="htmlwidget-a904450f171f14364aa3" style="width:672px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a904450f171f14364aa3">{"x":{"links":{"source":[2,4,0,5,0,3,0,3,1,2,0,6,5,1,0,0,1,0,0,1,17,16,17,2,16,2,1,0,19,16,1,7,0,17,18,21,16,14,10,12,24,22,11,2,7,15,23,1,0,2,0,0,0,4,5,0,1,3,2,0,2,8,9,20,10,21,11,25,12,16,24,14,19,13,23,7,15,22],"target":[8,27,27,27,28,29,29,9,9,9,9,32,32,30,30,1,13,13,31,31,18,18,20,20,20,21,2,2,22,22,23,23,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,3,3,3,4,5,6,6,6,26,26,26,26,7,7,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["Mr Hi","Actor 2","Actor 3","Actor 4","Actor 5","Actor 6","Actor 7","Actor 9","Actor 10","Actor 14","Actor 15","Actor 16","Actor 19","Actor 20","Actor 21","Actor 23","Actor 24","Actor 25","Actor 26","Actor 27","Actor 28","Actor 29","Actor 30","Actor 31","Actor 32","Actor 33","Actor 8","Actor 11","Actor 12","Actor 13","Actor 18","Actor 22","Actor 17","John A"],"group":[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.23: Interactive force-directed <code>networkD3</code> rendering of the Karate graph
</p>
</div>
<p>Other types of <code>D3</code> network visualizations are also available such as <code><a href="https://rdrr.io/pkg/networkD3/man/chordNetwork.html">chordNetwork()</a></code>, and <code><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork()</a></code>, with many of these more appropriate for data visualization purposes than for the exploration and analysis of networks. As a quick example of using <code><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork()</a></code> to visualize data flows, load the <code>eu_referendum</code> data set from the <code>onadata</code> package or download it from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/eu_referendum.csv" class="uri"&gt;https://ona-book.org/data/eu_referendum.csv&lt;/a&gt;&lt;/p&gt;'><sup>38</sup></a>. This shows statistics on voting by region and area in the United Kingdom’s 2016 referendum on membership of the European Union. In this example, we will calculate the ‘Leave’ and ‘Remain’ votes by region and visualize them using <code><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork()</a></code>, with the result shown in Interactive Figure <a href="viz-graphs.html#fig:eu-sankey">3.24</a>. It is worth taking a look at the intermediate objects created by this code so you can better understand how to construct the <code>Nodes</code> and <code>Links</code> dataframes that are commonly expected by <code>networkD3</code> functions.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networkD3">networkD3</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get data</span></span>
<span><span class="va">eu_referendum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://ona-book.org/data/eu_referendum.csv"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># aggregate by region</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">eu_referendum</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Remain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Remain</span><span class="op">)</span>, Leave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Leave</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">Region</span>, names_to <span class="op">=</span> <span class="st">"result"</span>, </span>
<span>                      values_to <span class="op">=</span> <span class="st">"votes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create unique regions, "Leave" and "Remain" for nodes dataframe</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span>, </span>
<span>                    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">regions</span>, <span class="st">"Leave"</span>, <span class="st">"Remain"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create edges/links dataframe</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">nodes</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span> <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">nodes</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"result"</span> <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">links</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"node.x"</span>, <span class="st">"node.y"</span>, <span class="st">"votes"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">links</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"target"</span>, <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize using sankeyNetwork</span></span>
<span><span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork</a></span><span class="op">(</span></span>
<span>  Links <span class="op">=</span> <span class="va">links</span>, Nodes <span class="op">=</span> <span class="va">nodes</span>, Source <span class="op">=</span> <span class="st">'source'</span>, Target <span class="op">=</span> <span class="st">'target'</span>, </span>
<span>  Value <span class="op">=</span> <span class="st">'value'</span>, NodeID <span class="op">=</span> <span class="st">'name'</span>, units <span class="op">=</span> <span class="st">'votes'</span>, fontSize <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:eu-sankey"></span>
<div id="htmlwidget-ebedfbfc52d82635d988" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ebedfbfc52d82635d988">{"x":{"links":{"source":[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11],"target":[13,12,13,12,13,12,13,12,13,12,13,12,13,12,13,12,13,12,13,12,13,12,13,12],"value":[1448616,1880367,1033036,1475479,2263519,1513232,562595,778103,1699020,1966925,440707,349442,1661191,1018322,2391718,2567965,1503019,1669711,772347,854572,1207175,1755687,1158298,1580937]},"nodes":{"name":["East","East Midlands","London","North East","North West","Northern Ireland","Scotland","South East","South West","Wales","West Midlands","Yorkshire and The Humber","Leave","Remain"],"group":["East","East Midlands","London","North East","North West","Northern Ireland","Scotland","South East","South West","Wales","West Midlands","Yorkshire and The Humber","Leave","Remain"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"votes","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.24: Interactive visualization of regional vote flows in the UK’s European Union Referendum in 2016 using <code><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html">sankeyNetwork()</a></code>
</p>
</div>
<div class="thinkahead">
<p><strong>Thinking ahead:</strong> As we have shown in the examples in this section, the <code>networkD3</code> package offers useful, convenient ways for non-Javascript programmers to make use of many of the great capabilities of the D3 visualization library. See <a href="https://christophergandrud.github.io/networkD3/">https://christophergandrud.github.io/networkD3/</a> for more examples. However, the package’s customization potential is limited. For those who can program in D3, the scope exists to create amazing interactive graph visualizations, with limitless customization potential.</p>
</div>
</div>
</div>
<div id="visualizing-graphs-in-python" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Visualizing graphs in Python<a class="anchor" aria-label="anchor" href="#visualizing-graphs-in-python"><i class="fas fa-link"></i></a>
</h2>
<p>We will look at two approaches to graph visualization in Python. First, we will look at static graph plotting via the <code>networkx</code> and <code>matplotlib</code> packages. Then we will look at interactive plotting via the <code>pyvis</code> package. As in the previous section, we will work with Zachary’s Karate Club to demonstrate most of the visualization options. Let’s load and create that graph object now.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="viz-graphs.html#cb215-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb215-2"><a href="viz-graphs.html#cb215-2" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb215-3"><a href="viz-graphs.html#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="viz-graphs.html#cb215-4" tabindex="-1"></a><span class="co"># get edgelist as Pandas DataFrame</span></span>
<span id="cb215-5"><a href="viz-graphs.html#cb215-5" tabindex="-1"></a>karate_edgelist <span class="op">=</span> pd.read_csv(<span class="st">"https://ona-book.org/data/karate.csv"</span>)</span>
<span id="cb215-6"><a href="viz-graphs.html#cb215-6" tabindex="-1"></a></span>
<span id="cb215-7"><a href="viz-graphs.html#cb215-7" tabindex="-1"></a><span class="co"># create graph from Pandas DataFrame</span></span>
<span id="cb215-8"><a href="viz-graphs.html#cb215-8" tabindex="-1"></a>karate <span class="op">=</span> nx.from_pandas_edgelist(karate_edgelist, </span>
<span id="cb215-9"><a href="viz-graphs.html#cb215-9" tabindex="-1"></a>source <span class="op">=</span> <span class="st">'from'</span>, target <span class="op">=</span> <span class="st">'to'</span>)</span></code></pre></div>
<div id="static-plotting-using-networkx-and-matplotlib" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Static plotting using <code>networkx</code> and <code>matplotlib</code><a class="anchor" aria-label="anchor" href="#static-plotting-using-networkx-and-matplotlib"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>draw()</code> function in <code>networkx</code> provides a basic visualization of a graph in <code>matplotlib</code> using a force-directed “spring” layout, as can be seen in Figure <a href="viz-graphs.html#fig:pykarate-basic">3.25</a>. Remember also to set a seed to ensure reproducibility of the visualization.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="viz-graphs.html#cb216-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb216-2"><a href="viz-graphs.html#cb216-2" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb216-3"><a href="viz-graphs.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="viz-graphs.html#cb216-4" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb216-5"><a href="viz-graphs.html#cb216-5" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb216-6"><a href="viz-graphs.html#cb216-6" tabindex="-1"></a></span>
<span id="cb216-7"><a href="viz-graphs.html#cb216-7" tabindex="-1"></a>fig <span class="op">=</span> nx.draw(karate)</span>
<span id="cb216-8"><a href="viz-graphs.html#cb216-8" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pykarate-basic"></span>
<img src="www/visualizing-graphs/pykarate-basic-1.png" alt="Basic static visualization of Karate network" width="90%"><p class="caption">
Figure 3.25: Basic static visualization of Karate network
</p>
</div>
<p>The <code>draw_networkx()</code> function has a much wider range of options for customizing the appearance of graphs. For example, we can change the color of all or specific nodes or edges, or label specific nodes but not others, such as in Figure <a href="viz-graphs.html#fig:pykarateadditional">3.26</a>.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="viz-graphs.html#cb217-1" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb217-2"><a href="viz-graphs.html#cb217-2" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb217-3"><a href="viz-graphs.html#cb217-3" tabindex="-1"></a></span>
<span id="cb217-4"><a href="viz-graphs.html#cb217-4" tabindex="-1"></a><span class="co"># create dict with labels only for Mr Hi and John A</span></span>
<span id="cb217-5"><a href="viz-graphs.html#cb217-5" tabindex="-1"></a>node <span class="op">=</span> <span class="bu">list</span>(karate.nodes)</span>
<span id="cb217-6"><a href="viz-graphs.html#cb217-6" tabindex="-1"></a>labels <span class="op">=</span> [i <span class="cf">if</span> i <span class="op">==</span> <span class="st">"Mr Hi"</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">"John A"</span> <span class="cf">else</span> <span class="st">""</span> </span>
<span id="cb217-7"><a href="viz-graphs.html#cb217-7" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> karate.nodes]</span>
<span id="cb217-8"><a href="viz-graphs.html#cb217-8" tabindex="-1"></a>nodelabels <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(node, labels))</span>
<span id="cb217-9"><a href="viz-graphs.html#cb217-9" tabindex="-1"></a></span>
<span id="cb217-10"><a href="viz-graphs.html#cb217-10" tabindex="-1"></a><span class="co"># create color list</span></span>
<span id="cb217-11"><a href="viz-graphs.html#cb217-11" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">"lightblue"</span> <span class="cf">if</span> i <span class="op">==</span> <span class="st">"Mr Hi"</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">"John A"</span> <span class="cf">else</span> <span class="st">"pink"</span> </span>
<span id="cb217-12"><a href="viz-graphs.html#cb217-12" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> karate.nodes]</span>
<span id="cb217-13"><a href="viz-graphs.html#cb217-13" tabindex="-1"></a></span>
<span id="cb217-14"><a href="viz-graphs.html#cb217-14" tabindex="-1"></a>nx.draw_networkx(karate, labels <span class="op">=</span> nodelabels, node_color <span class="op">=</span> colors, </span>
<span id="cb217-15"><a href="viz-graphs.html#cb217-15" tabindex="-1"></a>edge_color <span class="op">=</span> <span class="st">"grey"</span>)</span>
<span id="cb217-16"><a href="viz-graphs.html#cb217-16" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pykarateadditional"></span>
<img src="www/visualizing-graphs/pykarateadditional-1.png" alt="Static visualization of Karate network with adjustments to color and labeling" width="90%"><p class="caption">
Figure 3.26: Static visualization of Karate network with adjustments to color and labeling
</p>
</div>
<p>A limited selection of layouts is available and can be applied to the static visualization. For example, this is how to apply a circular layout, with the output in Figure <a href="viz-graphs.html#fig:pykaratecirc">3.27</a>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="viz-graphs.html#cb218-1" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb218-2"><a href="viz-graphs.html#cb218-2" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb218-3"><a href="viz-graphs.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="viz-graphs.html#cb218-4" tabindex="-1"></a><span class="co"># circular layout</span></span>
<span id="cb218-5"><a href="viz-graphs.html#cb218-5" tabindex="-1"></a>nx.draw_circular(karate, labels <span class="op">=</span> nodelabels, node_color <span class="op">=</span> colors, </span>
<span id="cb218-6"><a href="viz-graphs.html#cb218-6" tabindex="-1"></a>edge_color <span class="op">=</span> <span class="st">"grey"</span>)</span>
<span id="cb218-7"><a href="viz-graphs.html#cb218-7" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pykaratecirc"></span>
<img src="www/visualizing-graphs/pykaratecirc-1.png" alt="Static visualization of Karate network with circular layout" width="90%"><p class="caption">
Figure 3.27: Static visualization of Karate network with circular layout
</p>
</div>
<p>This is how to apply a Kamada-Kawai force-directed layout, with the output in Figure <a href="viz-graphs.html#fig:pykarateshell">3.28</a>. Note that some layout algorithms like Kamada-Kawai make use of the <code>scipy</code> package and therefore this will need to be installed in your Python environment.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="viz-graphs.html#cb219-1" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb219-2"><a href="viz-graphs.html#cb219-2" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb219-3"><a href="viz-graphs.html#cb219-3" tabindex="-1"></a></span>
<span id="cb219-4"><a href="viz-graphs.html#cb219-4" tabindex="-1"></a><span class="co"># circular layout</span></span>
<span id="cb219-5"><a href="viz-graphs.html#cb219-5" tabindex="-1"></a>nx.draw_kamada_kawai(karate, labels <span class="op">=</span> nodelabels, node_color <span class="op">=</span> colors, </span>
<span id="cb219-6"><a href="viz-graphs.html#cb219-6" tabindex="-1"></a>edge_color <span class="op">=</span> <span class="st">"grey"</span>)</span>
<span id="cb219-7"><a href="viz-graphs.html#cb219-7" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pykarateshell"></span>
<img src="www/visualizing-graphs/pykarateshell-1.png" alt="Static visualization of Karate network with Kamada-Kawai force-directed layout" width="90%"><p class="caption">
Figure 3.28: Static visualization of Karate network with Kamada-Kawai force-directed layout
</p>
</div>
<div class="thinkahead">
<p><strong>Playing around:</strong> The visual capabilities of <code>networkx</code> in Python are more limited than <code>igraph</code> or <code>ggraph</code> in R, but there still are a range of ways to customize your visualization. Try making further changes to the visualizations shown in this section by trying different layouts or by looking at the range of arguments that can be adjusted in the <code>draw_networkx()</code> function. You can look up more details on all this at <a href="https://networkx.org/documentation/stable/reference/drawing.html" class="uri">https://networkx.org/documentation/stable/reference/drawing.html</a>.</p>
</div>
</div>
<div id="interactive-visualization-using-networkx-and-pyvis" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Interactive visualization using <code>networkx</code> and <code>pyvis</code><a class="anchor" aria-label="anchor" href="#interactive-visualization-using-networkx-and-pyvis"><i class="fas fa-link"></i></a>
</h3>
<p>Similar to the <code>visNetwork</code> package in R, the <code>pyvis</code> package provides an API allowing the creation of interactive graphs using the <code>vis.js</code> Javascript library. As you will mostly be creating graph objects using <code>networkx</code>, the easiest way to use <code>pyvis</code> is to take advantage of its <code>networkx</code> integration.</p>
<p>To visualize a <code>networkx</code> graph using <code>pyvis</code>, start by creating a <code>Network()</code> class and then use the <code>from_nx()</code> method to import the <code>networkx</code> object. The <code><a href="https://rdrr.io/r/methods/show.html">show()</a></code> method will render an interactive plot.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="viz-graphs.html#cb220-1" tabindex="-1"></a><span class="im">from</span> pyvis.network <span class="im">import</span> Network</span>
<span id="cb220-2"><a href="viz-graphs.html#cb220-2" tabindex="-1"></a></span>
<span id="cb220-3"><a href="viz-graphs.html#cb220-3" tabindex="-1"></a><span class="co"># create pyvis Network object</span></span>
<span id="cb220-4"><a href="viz-graphs.html#cb220-4" tabindex="-1"></a>net <span class="op">=</span> Network(height <span class="op">=</span> <span class="st">"500px"</span>, width <span class="op">=</span> <span class="st">"600px"</span>, notebook <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb220-5"><a href="viz-graphs.html#cb220-5" tabindex="-1"></a></span>
<span id="cb220-6"><a href="viz-graphs.html#cb220-6" tabindex="-1"></a><span class="co"># import karate graph</span></span>
<span id="cb220-7"><a href="viz-graphs.html#cb220-7" tabindex="-1"></a>net.from_nx(karate)</span>
<span id="cb220-8"><a href="viz-graphs.html#cb220-8" tabindex="-1"></a>net.show(<span class="st">'out1.html'</span>)</span></code></pre></div>

        <iframe width="600px" height="500px" src="out1.html" frameborder="0" allowfullscreen></iframe>
        
<p><code>pyvis</code> expects specific names for the visual properties of nodes and edges, for example <code>color</code> and <code>size</code>. If these named properties are added to the nodes and edges dicts of the <code>networkx</code> object, they will be passed to <code>pyvis</code>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="viz-graphs.html#cb221-1" tabindex="-1"></a><span class="co"># adjust colors</span></span>
<span id="cb221-2"><a href="viz-graphs.html#cb221-2" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> karate.nodes:</span>
<span id="cb221-3"><a href="viz-graphs.html#cb221-3" tabindex="-1"></a>  karate.nodes[i][<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">20</span> <span class="cf">if</span> i <span class="op">==</span> <span class="st">"Mr Hi"</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">"John A"</span> \</span>
<span id="cb221-4"><a href="viz-graphs.html#cb221-4" tabindex="-1"></a>  <span class="cf">else</span> <span class="dv">10</span></span>
<span id="cb221-5"><a href="viz-graphs.html#cb221-5" tabindex="-1"></a>  </span>
<span id="cb221-6"><a href="viz-graphs.html#cb221-6" tabindex="-1"></a>  karate.nodes[i][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">"lightblue"</span> <span class="cf">if</span> i <span class="op">==</span> <span class="st">"Mr Hi"</span> \</span>
<span id="cb221-7"><a href="viz-graphs.html#cb221-7" tabindex="-1"></a>  <span class="kw">or</span> i <span class="op">==</span> <span class="st">"John A"</span> <span class="cf">else</span> <span class="st">"pink"</span> </span>
<span id="cb221-8"><a href="viz-graphs.html#cb221-8" tabindex="-1"></a></span>
<span id="cb221-9"><a href="viz-graphs.html#cb221-9" tabindex="-1"></a><span class="co"># create edge color</span></span>
<span id="cb221-10"><a href="viz-graphs.html#cb221-10" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> karate.edges:</span>
<span id="cb221-11"><a href="viz-graphs.html#cb221-11" tabindex="-1"></a>  karate.edges[i][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">"grey"</span></span>
<span id="cb221-12"><a href="viz-graphs.html#cb221-12" tabindex="-1"></a>  </span>
<span id="cb221-13"><a href="viz-graphs.html#cb221-13" tabindex="-1"></a><span class="co"># create pyvis Network object</span></span>
<span id="cb221-14"><a href="viz-graphs.html#cb221-14" tabindex="-1"></a>net <span class="op">=</span> Network(height <span class="op">=</span> <span class="st">"500px"</span>, width <span class="op">=</span> <span class="st">"600px"</span>, notebook <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb221-15"><a href="viz-graphs.html#cb221-15" tabindex="-1"></a>  </span>
<span id="cb221-16"><a href="viz-graphs.html#cb221-16" tabindex="-1"></a><span class="co"># import from networkx to pyvis and display</span></span>
<span id="cb221-17"><a href="viz-graphs.html#cb221-17" tabindex="-1"></a>net.from_nx(karate)</span>
<span id="cb221-18"><a href="viz-graphs.html#cb221-18" tabindex="-1"></a>net.show(<span class="st">'out2.html'</span>)</span></code></pre></div>

        <iframe width="600px" height="500px" src="out2.html" frameborder="0" allowfullscreen></iframe>
        
<div class="thinkahead">
<p><strong>Playing around:</strong> Different user interface controls can be added directly onto your <code>pyvis</code> visualizations using the <code>show_buttons()</code> method allowing you to experiment directly with the graph’s look and feel. For example, you can add buttons to experiment with the physics of the force-directed layout, or the node or edge properties. This can be useful when you are experimenting with options. You can learn more at the tutorial pages at <a href="https://pyvis.readthedocs.io/en/latest/" class="uri">https://pyvis.readthedocs.io/en/latest/</a>.</p>
</div>
</div>
</div>
<div id="learning-exercises-2" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Learning exercises<a class="anchor" aria-label="anchor" href="#learning-exercises-2"><i class="fas fa-link"></i></a>
</h2>
<div id="discussion-questions-2" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Discussion questions<a class="anchor" aria-label="anchor" href="#discussion-questions-2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Why is visualization an important consideration when studying graphs?</li>
<li>Describe some ways a graph visualization can be adjusted to reflect different characteristics of the vertices. For example, how might we represent more ‘important’ vertices visually?</li>
<li>Describe some similar adjustments that could be made to the edges.</li>
<li>Describe some likely challenges with large graph visualizations which may make it harder to draw conclusions from them.</li>
<li>What is the difference between a static and an iteractive visualization? In what ways might interactive visualizations overcome some of the challenges associated with large static graph visualizations?</li>
<li>Choose your favorite programming language and list out some package options for how to visualize graphs in that language.</li>
<li>For each package option you listed, describe what kinds of graphs each package would be best suited for.</li>
<li>Describe what is meant by a graph layout.</li>
<li>List some layout options which are available in the packages you selected for Questions 6 and 7.</li>
<li>If you visualize the same graph twice using the same layout, the outputs may look different. Why is this the case and what can be done to control it?</li>
</ol>
</div>
<div id="data-exercises-2" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Data exercises<a class="anchor" aria-label="anchor" href="#data-exercises-2"><i class="fas fa-link"></i></a>
</h3>
<p>Load the <code>madmen_vertices</code> and <code>madmen_edges</code> data sets from the <code>onadata</code> package or download them from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/madmen_vertices.csv" class="uri"&gt;https://ona-book.org/data/madmen_vertices.csv&lt;/a&gt; and &lt;a href="https://ona-book.org/data/madmen_edges.csv" class="uri"&gt;https://ona-book.org/data/madmen_edges.csv&lt;/a&gt;&lt;/p&gt;'><sup>39</sup></a>. This represents a network of characters from the TV show <em>Mad Men</em> with two characters connected by an edge if they were involved in a romantic relationship together.</p>
<ol style="list-style-type: decimal">
<li>Create a graph object from these data sets.</li>
<li>Create a basic visualization of the network using one of the methods from this chapter.</li>
<li>Adjust your visualization to distinguish between Male and Female characters.</li>
<li>Adjust your visualization to highlight the six main characters.</li>
<li>Adjust your visualization to differentiate between relationships where the characters were married or not married.</li>
<li>Experiment with different layouts. Which one do you prefer and why?</li>
</ol>
<p>Now load the <code>schoolfriends_vertices</code> and <code>schoolfriends_edgelist</code> data sets from the <code>onadata</code> package or download them from the internet<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ona-book.org/data/schoolfriends_vertices.csv" class="uri"&gt;https://ona-book.org/data/schoolfriends_vertices.csv&lt;/a&gt; and &lt;a href="https://ona-book.org/data/schoolfriends_edgelist.csv" class="uri"&gt;https://ona-book.org/data/schoolfriends_edgelist.csv&lt;/a&gt;&lt;/p&gt;'><sup>40</sup></a>. This data set represents friendships reported between schoolchildren in a high school in Marseille, France in 2013. The vertex set provides the ID, class and gender of each child, and the edgelist has two types of relationships. The first type is a reported friendship where the <code>from</code> ID reported the <code>to</code> ID as a friend. The second type is a known Facebook friendship between the two IDs.</p>
<ol start="7" style="list-style-type: decimal">
<li>Create two different graph objects—one for the reported friendship and the other for the Facebook friendship. Why is one graph object different from the other?</li>
<li>Create a basic visualization of both graphs using a method of your choice. Try to create versions of the graphs that contain isolates (nodes not connected to others) and do not contain isolates.</li>
<li>Experiment with different layouts for your visualization. Which one do you prefer and why? Do you see any potential communities in these graphs? Which type of friendship appears to be more ‘selective’ in your opinion?</li>
<li>Adjust both visualizations to differentiate the vertices by gender. Which type of relationship is more likely to be gender-agnostic in your opinion? Try the same question for class differentiation.</li>
</ol>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="working.html"><span class="header-section-number">2</span> Working with Graphs</a></div>
<div class="next"><a href="restructuring-data.html"><span class="header-section-number">4</span> Restructuring Data for Use in Graphs</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#viz-graphs"><span class="header-section-number">3</span> Visualizing Graphs</a></li>
<li>
<a class="nav-link" href="#visualizing-graphs-in-r"><span class="header-section-number">3.1</span> Visualizing graphs in R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#native-plotting-igraph"><span class="header-section-number">3.1.1</span> Native plotting in igraph</a></li>
<li><a class="nav-link" href="#layouts"><span class="header-section-number">3.1.2</span> Graph layouts</a></li>
<li><a class="nav-link" href="#ggraph"><span class="header-section-number">3.1.3</span> Static plotting with ggraph</a></li>
<li><a class="nav-link" href="#interactive-graph-visualization-using-visnetwork"><span class="header-section-number">3.1.4</span> Interactive graph visualization using visNetwork</a></li>
<li><a class="nav-link" href="#interactive-graph-visualization-using-networkd3"><span class="header-section-number">3.1.5</span> Interactive graph visualization using networkD3</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#visualizing-graphs-in-python"><span class="header-section-number">3.2</span> Visualizing graphs in Python</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#static-plotting-using-networkx-and-matplotlib"><span class="header-section-number">3.2.1</span> Static plotting using networkx and matplotlib</a></li>
<li><a class="nav-link" href="#interactive-visualization-using-networkx-and-pyvis"><span class="header-section-number">3.2.2</span> Interactive visualization using networkx and pyvis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#learning-exercises-2"><span class="header-section-number">3.3</span> Learning exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#discussion-questions-2"><span class="header-section-number">3.3.1</span> Discussion questions</a></li>
<li><a class="nav-link" href="#data-exercises-2"><span class="header-section-number">3.3.2</span> Data exercises</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/keithmcnulty/ona_book/blob/master/r/04-visualizing_graphs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/keithmcnulty/ona_book/edit/master/r/04-visualizing_graphs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Handbook of Graphs and Networks in People Analytics</strong>: With Examples in R and Python" was written by Keith McNulty. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
